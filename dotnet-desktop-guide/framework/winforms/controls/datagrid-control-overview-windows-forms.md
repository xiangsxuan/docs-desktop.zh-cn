---
title: DataGrid 控件概述
ms.date: 03/30/2017
f1_keywords:
- DataGrid
helpviewer_keywords:
- datasets [Windows Forms], binding to DataGrid control
- data binding [Windows Forms], DataGrid control
- columns [Windows Forms], DataGrid control
- data sources [Windows Forms], binding to DataGrid control
- tables [Windows Forms], binding to DataGrid control
- DataGrid control [Windows Forms], data binding
- DataGrid control [Windows Forms], about DataGrid control
- parent tables in DataGrid control
- tables [Windows Forms], displaying in DataGrid control
- data grids [Windows Forms], about data grids
- multiple tables in DataGrid control
- data [Windows Forms], resorting
- data [Windows Forms], navigating
- parent table navigation in DataGrid
- child tables [Windows Forms], dataGrid control
ms.assetid: 85604bce-bc03-49d9-9030-dda8896c44b1
ms.openlocfilehash: df559926dbc9141276f0a03deb99e340fd7212da
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/09/2020
ms.locfileid: "96970143"
---
# <a name="datagrid-control-overview-windows-forms"></a><span data-ttu-id="f43d7-102">DataGrid 控件概述（Windows 窗体）</span><span class="sxs-lookup"><span data-stu-id="f43d7-102">DataGrid Control Overview (Windows Forms)</span></span>

> [!NOTE]
> <span data-ttu-id="f43d7-103"><xref:System.Windows.Forms.DataGridView> 控件取代了 <xref:System.Windows.Forms.DataGrid> 控件并添加了功能；但是，可以选择保留 <xref:System.Windows.Forms.DataGrid> 控件以实现向后兼容并供将来使用。</span><span class="sxs-lookup"><span data-stu-id="f43d7-103">The <xref:System.Windows.Forms.DataGridView> control replaces and adds functionality to the <xref:System.Windows.Forms.DataGrid> control; however, the <xref:System.Windows.Forms.DataGrid> control is retained for both backward compatibility and future use, if you choose.</span></span> <span data-ttu-id="f43d7-104">有关详细信息，请参阅 [Windows 窗体 DataGridView 控件与 DataGrid 控件之间的区别](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-104">For more information, see [Differences Between the Windows Forms DataGridView and DataGrid Controls](differences-between-the-windows-forms-datagridview-and-datagrid-controls.md).</span></span>

<span data-ttu-id="f43d7-105">Windows 窗体 <xref:System.Windows.Forms.DataGrid> 控件将数据显示在一些列行和列中。</span><span class="sxs-lookup"><span data-stu-id="f43d7-105">The Windows Forms <xref:System.Windows.Forms.DataGrid> control displays data in a series of rows and columns.</span></span> <span data-ttu-id="f43d7-106">最简单的情况是网格绑定到不包含任何关系的单个表的数据源。</span><span class="sxs-lookup"><span data-stu-id="f43d7-106">The simplest case is when the grid is bound to a data source with a single table that contains no relationships.</span></span> <span data-ttu-id="f43d7-107">在这种情况下，数据显示在简单的行和列中，如在电子表格中一样。</span><span class="sxs-lookup"><span data-stu-id="f43d7-107">In that case, the data appears in simple rows and columns, as in a spreadsheet.</span></span> <span data-ttu-id="f43d7-108">有关将数据绑定到其他控件的详细信息，请参阅[数据绑定和 Windows 窗体](../data-binding-and-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-108">For more information about binding data to other controls, see [Data Binding and Windows Forms](../data-binding-and-windows-forms.md).</span></span>

<span data-ttu-id="f43d7-109">如果 <xref:System.Windows.Forms.DataGrid> 绑定到多个相关表的数据，并在网格上启用了导航功能，则网格中的每行都将显示扩展器。</span><span class="sxs-lookup"><span data-stu-id="f43d7-109">If the <xref:System.Windows.Forms.DataGrid> is bound to data with multiple related tables, and if navigation is enabled on the grid, the grid will display expanders in each row.</span></span> <span data-ttu-id="f43d7-110">借助扩展器，用户可以从父表移到子表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-110">With an expander, the user can move from a parent table to a child table.</span></span> <span data-ttu-id="f43d7-111">单击节点将显示子表，单击后退按钮将显示原始父表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-111">Clicking a node displays the child table, and clicking a back button displays the original parent table.</span></span> <span data-ttu-id="f43d7-112">网格以这种方式显示表与表之间的层次结构关系。</span><span class="sxs-lookup"><span data-stu-id="f43d7-112">In this manner, the grid displays the hierarchical relationships between tables.</span></span>

<span data-ttu-id="f43d7-113">以下屏幕截图显示了绑定到具有多个表的数据的 DataGrid：</span><span class="sxs-lookup"><span data-stu-id="f43d7-113">The following screenshot shows a DataGrid bound to data with multiple tables:</span></span>

![WinForms 应用，显示绑定到包含多个表的数据的数据网格。](./media/datagrid-control-overview-windows-forms/datagrid-bound-multiple-tables.gif)

<span data-ttu-id="f43d7-115"><xref:System.Windows.Forms.DataGrid> 可提供数据集、相关表之间导航以及丰富格式设置和编辑功能的用户界面。</span><span class="sxs-lookup"><span data-stu-id="f43d7-115">The <xref:System.Windows.Forms.DataGrid> can provide a user interface for a dataset, navigation between related tables, and rich formatting and editing capabilities.</span></span>

<span data-ttu-id="f43d7-116">数据的显示和操作是单独的函数：控件处理用户界面，而数据更新由 Windows 窗体的数据绑定体系结构和 .NET Framework 数据提供程序处理。</span><span class="sxs-lookup"><span data-stu-id="f43d7-116">The display and manipulation of data are separate functions: The control handles the user interface, whereas data updates are handled by the Windows Forms data-binding architecture and by .NET Framework data providers.</span></span> <span data-ttu-id="f43d7-117">因此绑定到同一数据源的多个控件将保持同步。</span><span class="sxs-lookup"><span data-stu-id="f43d7-117">Therefore, multiple controls bound to the same data source will stay in sync.</span></span>

> [!NOTE]
> <span data-ttu-id="f43d7-118">如果你熟悉 Visual Basic 6.0 中的 DataGrid 控件，就会发现 Windows 窗体 <xref:System.Windows.Forms.DataGrid> 控件中的一些重要差异。</span><span class="sxs-lookup"><span data-stu-id="f43d7-118">If you are familiar with the DataGrid control in Visual Basic 6.0, you will find some significant differences in the Windows Forms <xref:System.Windows.Forms.DataGrid> control.</span></span>

<span data-ttu-id="f43d7-119">当网格绑定到 <xref:System.Data.DataSet> 时，会自动创建列和行，同时对其格式进行设置并填充数据。</span><span class="sxs-lookup"><span data-stu-id="f43d7-119">When the grid is bound to a <xref:System.Data.DataSet>, the columns and rows are automatically created, formatted, and filled.</span></span> <span data-ttu-id="f43d7-120">有关详细信息，请参阅[数据绑定和 Windows 窗体](../data-binding-and-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-120">For more information, see [Data Binding and Windows Forms](../data-binding-and-windows-forms.md).</span></span> <span data-ttu-id="f43d7-121">生成 <xref:System.Windows.Forms.DataGrid> 控件后，可根据需要对列和行进行添加、删除、重新排列以及设置格式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-121">Following the generation of the <xref:System.Windows.Forms.DataGrid> control, you can add, delete, rearrange, and format columns and rows depending on your needs.</span></span>

## <a name="binding-data-to-the-control"></a><span data-ttu-id="f43d7-122">将数据绑定到控件</span><span class="sxs-lookup"><span data-stu-id="f43d7-122">Binding Data to the Control</span></span>

<span data-ttu-id="f43d7-123">若要使 <xref:System.Windows.Forms.DataGrid> 控件起作用，应在设计时使用 <xref:System.Windows.Forms.DataGrid.DataSource%2A> 和 <xref:System.Windows.Forms.DataGrid.DataMember%2A> 属性或在运行时使用 <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> 方法将该控件绑定到数据源。</span><span class="sxs-lookup"><span data-stu-id="f43d7-123">For the <xref:System.Windows.Forms.DataGrid> control to work, it should be bound to a data source using the <xref:System.Windows.Forms.DataGrid.DataSource%2A> and <xref:System.Windows.Forms.DataGrid.DataMember%2A> properties at design time or the <xref:System.Windows.Forms.DataGrid.SetDataBinding%2A> method at run time.</span></span> <span data-ttu-id="f43d7-124">通过这种绑定，可以使 <xref:System.Windows.Forms.DataGrid> 指向一个实例化的数据源对象，如 <xref:System.Data.DataSet> 或 <xref:System.Data.DataTable>。</span><span class="sxs-lookup"><span data-stu-id="f43d7-124">This binding points the <xref:System.Windows.Forms.DataGrid> to an instantiated data-source object, such as a <xref:System.Data.DataSet> or <xref:System.Data.DataTable>).</span></span> <span data-ttu-id="f43d7-125"><xref:System.Windows.Forms.DataGrid> 控件显示对数据执行操作所产生的结果。</span><span class="sxs-lookup"><span data-stu-id="f43d7-125">The <xref:System.Windows.Forms.DataGrid> control shows the results of actions that are performed on the data.</span></span> <span data-ttu-id="f43d7-126">大多数特定于数据的操作并不是通过 <xref:System.Windows.Forms.DataGrid> 执行的，而是通过数据源执行。</span><span class="sxs-lookup"><span data-stu-id="f43d7-126">Most data-specific actions are not performed through the <xref:System.Windows.Forms.DataGrid> , but instead through the data source.</span></span>

<span data-ttu-id="f43d7-127">如果绑定数据集中的数据通过任何机制进行了更新，那么 <xref:System.Windows.Forms.DataGrid> 控件会反映这些变化。</span><span class="sxs-lookup"><span data-stu-id="f43d7-127">If the data in the bound dataset is updated through any mechanism, the <xref:System.Windows.Forms.DataGrid> control reflects the changes.</span></span> <span data-ttu-id="f43d7-128">如果数据网格及其表样式和列样式的 `ReadOnly` 属性设置为 `false` ，则可通过控件更新数据集中的数据 <xref:System.Windows.Forms.DataGrid> 。</span><span class="sxs-lookup"><span data-stu-id="f43d7-128">If the data grid and its table styles and column styles have the `ReadOnly` property set to `false`, the data in the dataset can be updated through the <xref:System.Windows.Forms.DataGrid> control.</span></span>

<span data-ttu-id="f43d7-129"><xref:System.Windows.Forms.DataGrid> 一次只能显示一张表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-129">Only one table can be shown in the <xref:System.Windows.Forms.DataGrid> at a time.</span></span> <span data-ttu-id="f43d7-130">如果在表与表之间定义了父-子关系，则用户可以在相关表之间移动以选择要显示在 <xref:System.Windows.Forms.DataGrid> 控件中的表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-130">If a parent-child relationship is defined between tables, the user can move between the related tables to select the table to be displayed in the <xref:System.Windows.Forms.DataGrid> control.</span></span> <span data-ttu-id="f43d7-131">有关 <xref:System.Windows.Forms.DataGrid> 在设计时或运行时将控件绑定到 ADO.NET 数据源的信息，请参阅 [如何：将 Windows 窗体 DataGrid 控件绑定到数据源](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-131">For information about binding a <xref:System.Windows.Forms.DataGrid> control to an ADO.NET data source at either design time or run time, see [How to: Bind the Windows Forms DataGrid Control to a Data Source](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md).</span></span>

<span data-ttu-id="f43d7-132"><xref:System.Windows.Forms.DataGrid> 的有效数据源包括：</span><span class="sxs-lookup"><span data-stu-id="f43d7-132">Valid data sources for the <xref:System.Windows.Forms.DataGrid> include:</span></span>

- <span data-ttu-id="f43d7-133"><xref:System.Data.DataTable> 类</span><span class="sxs-lookup"><span data-stu-id="f43d7-133"><xref:System.Data.DataTable> class</span></span>

- <span data-ttu-id="f43d7-134"><xref:System.Data.DataView> 类</span><span class="sxs-lookup"><span data-stu-id="f43d7-134"><xref:System.Data.DataView> class</span></span>

- <span data-ttu-id="f43d7-135"><xref:System.Data.DataSet> 类</span><span class="sxs-lookup"><span data-stu-id="f43d7-135"><xref:System.Data.DataSet> class</span></span>

- <span data-ttu-id="f43d7-136"><xref:System.Data.DataViewManager> 类</span><span class="sxs-lookup"><span data-stu-id="f43d7-136"><xref:System.Data.DataViewManager> class</span></span>

<span data-ttu-id="f43d7-137">如果源是一个数据集，那么该数据集可能是窗体中的某个对象或由 XML Web 服务传递到该窗体的某个对象。</span><span class="sxs-lookup"><span data-stu-id="f43d7-137">If your source is a dataset, the dataset might be an object in the form or an object passed to the form by an XML Web service.</span></span> <span data-ttu-id="f43d7-138">可以绑定到类型化数据集，也可以绑定到非类型化数据集。</span><span class="sxs-lookup"><span data-stu-id="f43d7-138">You can bind to either typed or untyped datasets.</span></span>

<span data-ttu-id="f43d7-139">如果结构中的对象（例如数组中的元素）公开公共属性，则还可以将 <xref:System.Windows.Forms.DataGrid> 控件绑定到其他结构。</span><span class="sxs-lookup"><span data-stu-id="f43d7-139">You can also bind a <xref:System.Windows.Forms.DataGrid> control to additional structures if the objects in the structure, such as the elements in an array, expose public properties.</span></span> <span data-ttu-id="f43d7-140">网格将显示结构中该元素的所有公共属性。</span><span class="sxs-lookup"><span data-stu-id="f43d7-140">The grid will display all the public properties of the elements in the structure.</span></span> <span data-ttu-id="f43d7-141">例如，如果将 <xref:System.Windows.Forms.DataGrid> 控件绑定到客户对象数组，那么网格将显示这些客户对象的所有公共属性。</span><span class="sxs-lookup"><span data-stu-id="f43d7-141">For example, if you bind the <xref:System.Windows.Forms.DataGrid> control to an array of customer objects, the grid will display all the public properties of those customer objects.</span></span> <span data-ttu-id="f43d7-142">某些情况下，这意味着尽管可以绑定到结构，但最终绑定的结构可能不具有实际应用程序。</span><span class="sxs-lookup"><span data-stu-id="f43d7-142">In some instances, this means that although you can bind to the structure, the resulting bound structure might not have practical application.</span></span> <span data-ttu-id="f43d7-143">例如，你可以绑定到整数数组，但由于 `Integer` 数据类型不支持公共属性，因此该网格不会显示任何数据。</span><span class="sxs-lookup"><span data-stu-id="f43d7-143">For example, you can bind to an array of integers, but because the `Integer` data type does not support a public property, the grid cannot display any data.</span></span>

<span data-ttu-id="f43d7-144">如果其元素公开公共属性，则可以绑定到以下结构：</span><span class="sxs-lookup"><span data-stu-id="f43d7-144">You can bind to the following structures if their elements expose public properties:</span></span>

- <span data-ttu-id="f43d7-145">实现 <xref:System.Collections.IList> 接口的任意组件。</span><span class="sxs-lookup"><span data-stu-id="f43d7-145">Any component that implements the <xref:System.Collections.IList> interface.</span></span> <span data-ttu-id="f43d7-146">这包括单维数组。</span><span class="sxs-lookup"><span data-stu-id="f43d7-146">This includes single-dimension arrays.</span></span>

- <span data-ttu-id="f43d7-147">实现 <xref:System.ComponentModel.IListSource> 接口的任意组件。</span><span class="sxs-lookup"><span data-stu-id="f43d7-147">Any component that implements the <xref:System.ComponentModel.IListSource> interface.</span></span>

- <span data-ttu-id="f43d7-148">实现 <xref:System.ComponentModel.IBindingList> 接口的任意组件。</span><span class="sxs-lookup"><span data-stu-id="f43d7-148">Any component that implements the <xref:System.ComponentModel.IBindingList> interface.</span></span>

 <span data-ttu-id="f43d7-149">有关可能数据源的详细信息，请参阅 [Windows 窗体支持的数据源](../data-sources-supported-by-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-149">For more information about possible data sources, see [Data Sources Supported by Windows Forms](../data-sources-supported-by-windows-forms.md).</span></span>

## <a name="grid-display"></a><span data-ttu-id="f43d7-150">网格显示</span><span class="sxs-lookup"><span data-stu-id="f43d7-150">Grid Display</span></span>

<span data-ttu-id="f43d7-151"><xref:System.Windows.Forms.DataGrid> 控件的一个常见用途是显示数据集中的单个数据表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-151">A common use of the <xref:System.Windows.Forms.DataGrid> control is to display a single table of data from a dataset.</span></span> <span data-ttu-id="f43d7-152">但是，该控件还可以用于显示多个表，包括相关表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-152">However, the control can also be used to display multiple tables, including related tables.</span></span> <span data-ttu-id="f43d7-153">网格的显示可根据数据源自动调整。</span><span class="sxs-lookup"><span data-stu-id="f43d7-153">The display of the grid is adjusted automatically according to the data source.</span></span> <span data-ttu-id="f43d7-154">下表显示各种配置显示的内容。</span><span class="sxs-lookup"><span data-stu-id="f43d7-154">The following table shows what is displayed for various configurations.</span></span>

|<span data-ttu-id="f43d7-155">数据集内容</span><span class="sxs-lookup"><span data-stu-id="f43d7-155">Contents of data set</span></span>|<span data-ttu-id="f43d7-156">显示内容</span><span class="sxs-lookup"><span data-stu-id="f43d7-156">What is displayed</span></span>|
|--------------------------|-----------------------|
|<span data-ttu-id="f43d7-157">单个表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-157">Single table.</span></span>|<span data-ttu-id="f43d7-158">表显示在网格中。</span><span class="sxs-lookup"><span data-stu-id="f43d7-158">Table is displayed in a grid.</span></span>|
|<span data-ttu-id="f43d7-159">多个表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-159">Multiple tables.</span></span>|<span data-ttu-id="f43d7-160">网格可以显示树视图，用户可以通过浏览树视图找到希望显示的表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-160">The grid can display a tree view that users can navigate to locate the table they want to display.</span></span>|
|<span data-ttu-id="f43d7-161">多个相关表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-161">Multiple related tables.</span></span>|<span data-ttu-id="f43d7-162">网格可以显示树视图以便选择表格，你也可指定网格显示父表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-162">The grid can display a tree view to select tables with, or you can specify that the grid display the parent table.</span></span> <span data-ttu-id="f43d7-163">通过父表中的记录，用户可导航到相关的子行。</span><span class="sxs-lookup"><span data-stu-id="f43d7-163">Records in the parent table let users navigate to related child rows.</span></span>|

> [!NOTE]
> <span data-ttu-id="f43d7-164">使用 <xref:System.Data.DataRelation> 使数据集中的表相关。</span><span class="sxs-lookup"><span data-stu-id="f43d7-164">Tables in a dataset are related using a <xref:System.Data.DataRelation>.</span></span> <span data-ttu-id="f43d7-165">另请参阅 [创建数据集之间的关系](/visualstudio/data-tools/relationships-in-datasets)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-165">Also see [Create relationships between datasets](/visualstudio/data-tools/relationships-in-datasets).</span></span>

<span data-ttu-id="f43d7-166">当 <xref:System.Windows.Forms.DataGrid> 控件显示表并且 <xref:System.Windows.Forms.DataGrid.AllowSorting%2A> 属性设置为 `true` 时，可通过单击列标题对数据重新排序。</span><span class="sxs-lookup"><span data-stu-id="f43d7-166">When the <xref:System.Windows.Forms.DataGrid> control is displaying a table and the <xref:System.Windows.Forms.DataGrid.AllowSorting%2A> property is set to `true`, data can be resorted by clicking the column headers.</span></span> <span data-ttu-id="f43d7-167">用户还可以添加行和编辑单元格。</span><span class="sxs-lookup"><span data-stu-id="f43d7-167">The user can also add rows and edit cells.</span></span>

<span data-ttu-id="f43d7-168">通过使用父/子导航结构，向用户显示一组表之间的关系。</span><span class="sxs-lookup"><span data-stu-id="f43d7-168">The relationships between a set of tables are displayed to users by using a parent/child structure of navigation.</span></span> <span data-ttu-id="f43d7-169">父表是最高级别的数据，子表是派生自父表中各个列表的数据表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-169">Parent tables are the highest level of data, and child tables are those data tables that are derived from the individual listings in the parent tables.</span></span> <span data-ttu-id="f43d7-170">扩展器显示在包含子表的每个父行中。</span><span class="sxs-lookup"><span data-stu-id="f43d7-170">Expanders are displayed in each parent row that contains a child table.</span></span> <span data-ttu-id="f43d7-171">单击扩展器将生成指向子表的类似 Web 链接的列表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-171">Clicking an expander generates a list of Web-like links to the child tables.</span></span> <span data-ttu-id="f43d7-172">当用户选择某个链接时，将显示子表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-172">When the user selects a link, the child table is displayed.</span></span> <span data-ttu-id="f43d7-173">单击 "显示/隐藏父行" 图标 (</span><span class="sxs-lookup"><span data-stu-id="f43d7-173">Clicking the show/hide parent rows icon (</span></span>!["显示/隐藏父行" 图标](./media/datagrid-control-overview-windows-forms/show-hide-parent-rows.gif)<span data-ttu-id="f43d7-175">) 将隐藏父表的相关信息，或者如果用户以前隐藏了它，则会使其重新显示。</span><span class="sxs-lookup"><span data-stu-id="f43d7-175">) will hide the information about the parent table or cause it to reappear if the user has previously hidden it.</span></span> <span data-ttu-id="f43d7-176">用户可以单击后退按钮，返回到之前查看的表。</span><span class="sxs-lookup"><span data-stu-id="f43d7-176">The user can click a back button to move back to the previously viewed table.</span></span>

## <a name="columns-and-rows"></a><span data-ttu-id="f43d7-177">列和行</span><span class="sxs-lookup"><span data-stu-id="f43d7-177">Columns and Rows</span></span>

<span data-ttu-id="f43d7-178"><xref:System.Windows.Forms.DataGrid> 由 <xref:System.Windows.Forms.DataGrid> 控件的 <xref:System.Windows.Forms.DataGrid.TableStyles%2A> 属性中包含的 <xref:System.Windows.Forms.DataGridTableStyle> 对象集合组成。</span><span class="sxs-lookup"><span data-stu-id="f43d7-178">The <xref:System.Windows.Forms.DataGrid> consists of a collection of <xref:System.Windows.Forms.DataGridTableStyle> objects that are contained in the <xref:System.Windows.Forms.DataGrid> control's <xref:System.Windows.Forms.DataGrid.TableStyles%2A> property.</span></span> <span data-ttu-id="f43d7-179">表样式可能具有 <xref:System.Windows.Forms.DataGridTableStyle> 的 <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> 属性中包含的 <xref:System.Windows.Forms.DataGridColumnStyle> 对象集合。</span><span class="sxs-lookup"><span data-stu-id="f43d7-179">A table style may contain a collection of <xref:System.Windows.Forms.DataGridColumnStyle> objects that are contained in the <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> property of the <xref:System.Windows.Forms.DataGridTableStyle>..</span></span> <span data-ttu-id="f43d7-180">您可以 <xref:System.Windows.Forms.DataGrid.TableStyles%2A> <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> 通过使用通过 " **属性** " 窗口访问的集合编辑器来编辑和属性。</span><span class="sxs-lookup"><span data-stu-id="f43d7-180">You can edit the <xref:System.Windows.Forms.DataGrid.TableStyles%2A> and <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> properties by using collection editors accessed through the **Properties** window.</span></span>

<span data-ttu-id="f43d7-181">任何与 <xref:System.Windows.Forms.DataGrid> 控件关的联 <xref:System.Windows.Forms.DataGridTableStyle> 都可通过 <xref:System.Windows.Forms.GridTableStylesCollection> 进行访问。</span><span class="sxs-lookup"><span data-stu-id="f43d7-181">Any <xref:System.Windows.Forms.DataGridTableStyle> associated with the <xref:System.Windows.Forms.DataGrid> control can be accessed through the <xref:System.Windows.Forms.GridTableStylesCollection>.</span></span> <span data-ttu-id="f43d7-182">可利用 <xref:System.Windows.Forms.DataGridTableStyle> 集合编辑器在设计器中编辑 <xref:System.Windows.Forms.GridTableStylesCollection>，或以编程方式通过 <xref:System.Windows.Forms.DataGrid> 控件的 <xref:System.Windows.Forms.DataGrid.TableStyles%2A> 属性进行编辑。</span><span class="sxs-lookup"><span data-stu-id="f43d7-182">The <xref:System.Windows.Forms.GridTableStylesCollection> can be edited in the designer with the <xref:System.Windows.Forms.DataGridTableStyle> collection editor, or programmatically through the <xref:System.Windows.Forms.DataGrid> control's <xref:System.Windows.Forms.DataGrid.TableStyles%2A> property.</span></span>

<span data-ttu-id="f43d7-183">下图显示了 DataGrid 控件中包含的对象：</span><span class="sxs-lookup"><span data-stu-id="f43d7-183">The following illustration shows the objects included in the DataGrid control:</span></span>

![显示 DataGrid 控件中包含的对象的关系图。](./media/datagrid-control-overview-windows-forms/visual-basic-columns.gif)

<span data-ttu-id="f43d7-185">通过将表样式和列样式的 `MappingName` 属性设置为相应的 <xref:System.Data.DataTable.TableName%2A> 和 <xref:System.Data.DataColumn.ColumnName%2A> 属性，使它们与 <xref:System.Data.DataTable> 对象和 <xref:System.Data.DataColumn> 对象保持同步。</span><span class="sxs-lookup"><span data-stu-id="f43d7-185">Table styles and column styles are synchronized with <xref:System.Data.DataTable> objects and <xref:System.Data.DataColumn> objects by setting their `MappingName` properties to the appropriate <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataColumn.ColumnName%2A> properties.</span></span> <span data-ttu-id="f43d7-186">当将没有列样式的 <xref:System.Windows.Forms.DataGridTableStyle> 添加至绑定到有效数据源的 <xref:System.Windows.Forms.DataGrid> 控件，并且将该表样式的 <xref:System.Windows.Forms.DataGridTableStyle.MappingName%2A> 属性设置为有效的 <xref:System.Data.DataTable.TableName%2A> 属性时，会针对该表样式创建 <xref:System.Windows.Forms.DataGridColumnStyle> 对象集合。</span><span class="sxs-lookup"><span data-stu-id="f43d7-186">When a <xref:System.Windows.Forms.DataGridTableStyle> that has no column styles is added to a <xref:System.Windows.Forms.DataGrid> control bound to a valid data source, and the <xref:System.Windows.Forms.DataGridTableStyle.MappingName%2A> property of that table style is set to a valid <xref:System.Data.DataTable.TableName%2A> property, a collection of <xref:System.Windows.Forms.DataGridColumnStyle> objects is created for that table style.</span></span> <span data-ttu-id="f43d7-187">对于在 <xref:System.Data.DataTable> 的 <xref:System.Data.DataTable.Columns%2A> 集合中发现的每个 <xref:System.Data.DataColumn>，都会将相应的 <xref:System.Windows.Forms.DataGridColumnStyle> 添加至 <xref:System.Windows.Forms.GridColumnStylesCollection>。</span><span class="sxs-lookup"><span data-stu-id="f43d7-187">For each <xref:System.Data.DataColumn> found in the <xref:System.Data.DataTable.Columns%2A> collection of the <xref:System.Data.DataTable>, a corresponding <xref:System.Windows.Forms.DataGridColumnStyle> is added to the <xref:System.Windows.Forms.GridColumnStylesCollection>.</span></span> <span data-ttu-id="f43d7-188">通过 <xref:System.Windows.Forms.DataGridTableStyle> 的 <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> 属性访问 <xref:System.Windows.Forms.GridColumnStylesCollection>。</span><span class="sxs-lookup"><span data-stu-id="f43d7-188"><xref:System.Windows.Forms.GridColumnStylesCollection> is accessed through the <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> property of the <xref:System.Windows.Forms.DataGridTableStyle>.</span></span> <span data-ttu-id="f43d7-189">通过对 <xref:System.Windows.Forms.GridColumnStylesCollection> 使用 <xref:System.Windows.Forms.GridColumnStylesCollection.Add%2A> 或 <xref:System.Windows.Forms.GridColumnStylesCollection.Remove%2A> 方法在网格中添加或删除列。</span><span class="sxs-lookup"><span data-stu-id="f43d7-189">Columns can be added or deleted from the grid using the <xref:System.Windows.Forms.GridColumnStylesCollection.Add%2A> or <xref:System.Windows.Forms.GridColumnStylesCollection.Remove%2A> method on the <xref:System.Windows.Forms.GridColumnStylesCollection>.</span></span> <span data-ttu-id="f43d7-190">有关详细信息，请参阅[如何：向 Windows 窗体 DataGrid 控件添加表和列](how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md)和[如何：在 Windows 窗体 DataGrid 控件中删除或隐藏列](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-190">For more information, see [How to: Add Tables and Columns to the Windows Forms DataGrid Control](how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md) and [How to: Delete or Hide Columns in the Windows Forms DataGrid Control](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md).</span></span>

<span data-ttu-id="f43d7-191">列类型的集合可扩展具有丰富格式设置和编辑功能的 <xref:System.Windows.Forms.DataGridColumnStyle> 类。</span><span class="sxs-lookup"><span data-stu-id="f43d7-191">A collection of column types extends the <xref:System.Windows.Forms.DataGridColumnStyle> class with rich formatting and editing capabilities.</span></span> <span data-ttu-id="f43d7-192">所有列类型都继承自 <xref:System.Windows.Forms.DataGridColumnStyle> 基类。</span><span class="sxs-lookup"><span data-stu-id="f43d7-192">All column types inherit from the <xref:System.Windows.Forms.DataGridColumnStyle> base class.</span></span> <span data-ttu-id="f43d7-193">创建的类取决于 <xref:System.Web.UI.WebControls.DataGridColumn> 基于的 <xref:System.Data.DataColumn> 的 <xref:System.Data.DataColumn.DataType%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="f43d7-193">The class that is created depends on the <xref:System.Data.DataColumn.DataType%2A> property of the <xref:System.Data.DataColumn> from which the <xref:System.Web.UI.WebControls.DataGridColumn> is based.</span></span> <span data-ttu-id="f43d7-194">例如，<xref:System.Data.DataColumn.DataType%2A> 属性设置为 <xref:System.Boolean> 的 <xref:System.Data.DataColumn> 将与 <xref:System.Windows.Forms.DataGridBoolColumn> 关联。</span><span class="sxs-lookup"><span data-stu-id="f43d7-194">For example, a <xref:System.Data.DataColumn> that has its <xref:System.Data.DataColumn.DataType%2A> property set to <xref:System.Boolean> will be associated with the <xref:System.Windows.Forms.DataGridBoolColumn>.</span></span> <span data-ttu-id="f43d7-195">下表描述了每种列类型。</span><span class="sxs-lookup"><span data-stu-id="f43d7-195">The following table describes each of these column types.</span></span>

|<span data-ttu-id="f43d7-196">列类型</span><span class="sxs-lookup"><span data-stu-id="f43d7-196">Column Type</span></span>|<span data-ttu-id="f43d7-197">描述</span><span class="sxs-lookup"><span data-stu-id="f43d7-197">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Windows.Forms.DataGridTextBoxColumn>|<span data-ttu-id="f43d7-198">接受并显示数据为格式化或非格式化的字符串。</span><span class="sxs-lookup"><span data-stu-id="f43d7-198">Accepts and displays data as formatted or unformatted strings.</span></span> <span data-ttu-id="f43d7-199">编辑功能与在简单的 <xref:System.Windows.Forms.TextBox> 中编辑数据相同。</span><span class="sxs-lookup"><span data-stu-id="f43d7-199">Editing capabilities are the same as they are for editing data in a simple <xref:System.Windows.Forms.TextBox>.</span></span> <span data-ttu-id="f43d7-200">继承自 <xref:System.Windows.Forms.DataGridColumnStyle>。</span><span class="sxs-lookup"><span data-stu-id="f43d7-200">Inherits from <xref:System.Windows.Forms.DataGridColumnStyle>.</span></span>|
|<xref:System.Windows.Forms.DataGridBoolColumn>|<span data-ttu-id="f43d7-201">接受并显示 `true`、`false` 和 null 值。</span><span class="sxs-lookup"><span data-stu-id="f43d7-201">Accepts and displays `true`, `false`, and null values.</span></span> <span data-ttu-id="f43d7-202">继承自 <xref:System.Windows.Forms.DataGridColumnStyle>。</span><span class="sxs-lookup"><span data-stu-id="f43d7-202">Inherits from <xref:System.Windows.Forms.DataGridColumnStyle>.</span></span>|

<span data-ttu-id="f43d7-203">双击列的右边缘可调整列大小，以显示其完整的标题和最宽的条目。</span><span class="sxs-lookup"><span data-stu-id="f43d7-203">Double-clicking the right edge of a column resizes the column to display its full caption and widest entry.</span></span>

## <a name="table-styles-and-column-styles"></a><span data-ttu-id="f43d7-204">表样式和列样式</span><span class="sxs-lookup"><span data-stu-id="f43d7-204">Table Styles and Column Styles</span></span>

<span data-ttu-id="f43d7-205">建立了 <xref:System.Windows.Forms.DataGrid> 控件的默认格式后，便可以自定义在数据网格中显示某些表时将使用的颜色。</span><span class="sxs-lookup"><span data-stu-id="f43d7-205">As soon as you have established the default format of the <xref:System.Windows.Forms.DataGrid> control, you can customize the colors that will be used when certain tables are displayed within the data grid.</span></span>

<span data-ttu-id="f43d7-206">这可通过创建 <xref:System.Windows.Forms.DataGridTableStyle> 类中的实例得以实现。</span><span class="sxs-lookup"><span data-stu-id="f43d7-206">This is achieved by creating instances of the <xref:System.Windows.Forms.DataGridTableStyle> class.</span></span> <span data-ttu-id="f43d7-207">表样式指定了与 <xref:System.Windows.Forms.DataGrid> 控件本身默认格式设置不同的特定表的格式设置。</span><span class="sxs-lookup"><span data-stu-id="f43d7-207">Table styles specify the formatting of specific tables, distinct from the default formatting of the <xref:System.Windows.Forms.DataGrid> control itself.</span></span> <span data-ttu-id="f43d7-208">每张表每次只能定义一种表样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-208">Each table may have only one table style defined for it at a time.</span></span>

<span data-ttu-id="f43d7-209">有时，你会希望特定数据表中的特定列不同于表中的其他列。</span><span class="sxs-lookup"><span data-stu-id="f43d7-209">Sometimes, you will want to have a specific column look different from the rest of the columns of a particular data table.</span></span> <span data-ttu-id="f43d7-210">你可以通过使用 <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> 属性创建一组自定义的列样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-210">You can create a customized set of column styles by using the <xref:System.Windows.Forms.DataGridTableStyle.GridColumnStyles%2A> property.</span></span>

<span data-ttu-id="f43d7-211">列样式与数据集中列相关，同样，表样式也与数据表相关。</span><span class="sxs-lookup"><span data-stu-id="f43d7-211">Column styles are related to columns in a dataset just like table styles are related to data tables.</span></span> <span data-ttu-id="f43d7-212">与每张表每次只能定义一种表样式相同，在特定的表样式中每列也只能定义一种列样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-212">Just as each table may only have one table style defined for it at a time, so too can each column only have one column style defined for it, in a particular table style.</span></span> <span data-ttu-id="f43d7-213">此关系在列的 <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> 属性中定义。</span><span class="sxs-lookup"><span data-stu-id="f43d7-213">This relationship is defined in the column's <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> property.</span></span>

<span data-ttu-id="f43d7-214">如果创建了表样式，但未向其中添加列样式，则在运行时创建窗体和网格时，Visual Studio 将添加默认列样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-214">If you have created a table style without column styles added to it, Visual Studio will add default column styles when the form and grid are created at run time.</span></span> <span data-ttu-id="f43d7-215">但是，如果已经创建了表样式并向其中添加了任何列样式，则 Visual Studio 将不会创建任何列样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-215">However, if you have created a table style and added any column styles to it, Visual Studio will not create any column styles.</span></span> <span data-ttu-id="f43d7-216">此外，还需要定义列样式，并向它们分配映射名称以便在网格中显示你希望显示的列。</span><span class="sxs-lookup"><span data-stu-id="f43d7-216">Also, you will need to define column styles and assign them with the mapping name to have the columns that you want appear in the grid.</span></span>

<span data-ttu-id="f43d7-217">由于数据网格中包含的列是通过向它们分配列样式指定的，而尚未向列分配列样式，因此可包含网格中未显示的数据集中的数据列。</span><span class="sxs-lookup"><span data-stu-id="f43d7-217">Because you specify which columns are included in the data grid by assigning them a column style and no column style has been assigned to the columns, you can include columns of data in the dataset that are not displayed in the grid.</span></span> <span data-ttu-id="f43d7-218">然而，由于数据列包含在数据集中，因此可采用编程方式来编辑未显示的数据。</span><span class="sxs-lookup"><span data-stu-id="f43d7-218">However, because the data column is included in the dataset, you can programmatically edit the data that is not displayed.</span></span>

> [!NOTE]
> <span data-ttu-id="f43d7-219">一般情况下，应先创建列样式并将其添加到列样式集合，然后再向表样式集合添加表样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-219">In general, create column styles and add them to the column styles collection before adding table styles to the table styles collection.</span></span> <span data-ttu-id="f43d7-220">当将空表样式添加到集合时，会自动生成列样式。</span><span class="sxs-lookup"><span data-stu-id="f43d7-220">When you add an empty table style to the collection, column styles are automatically generated for you.</span></span> <span data-ttu-id="f43d7-221">因此，如果尝试向列样式集合添加具有重复 <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> 值的新列样式，则将引发异常。</span><span class="sxs-lookup"><span data-stu-id="f43d7-221">Consequently, an exception will be thrown if you try to add new column styles with duplicate <xref:System.Windows.Forms.DataGridColumnStyle.MappingName%2A> values to the column styles collection.</span></span>
>
> <span data-ttu-id="f43d7-222">有时，你可能只希望微调众多列中的某一列，例如，数据集包含 50 列，而你只需要其中的 49 列。</span><span class="sxs-lookup"><span data-stu-id="f43d7-222">Sometimes, you will want to just tweak one column among many columns; for example, the dataset contains 50 columns and you only want 49 of them.</span></span> <span data-ttu-id="f43d7-223">在这种情况下，相对简单的办法是导入所有 50 列，然后以编程方式删除其中的一列，而不是以编程方式添加 49 个单独的列。</span><span class="sxs-lookup"><span data-stu-id="f43d7-223">In this case, it is easier to import all 50 columns and programmatically remove one, rather than programmatically adding each of the 49 individual columns you want.</span></span>

## <a name="formatting"></a><span data-ttu-id="f43d7-224">格式化</span><span class="sxs-lookup"><span data-stu-id="f43d7-224">Formatting</span></span>

<span data-ttu-id="f43d7-225">可应用于 <xref:System.Windows.Forms.DataGrid> 控件的格式设置包括边框样式、网格线样式、字体、标题属性、数据对齐以及交替行之间的背景颜色。</span><span class="sxs-lookup"><span data-stu-id="f43d7-225">Formatting that can be applied to the <xref:System.Windows.Forms.DataGrid> control includes border styles, gridline styles, fonts, caption properties, data alignment, and alternating background colors between rows.</span></span> <span data-ttu-id="f43d7-226">有关详细信息，请参阅[如何：设置 Windows 窗体 DataGrid 控件的格式](how-to-format-the-windows-forms-datagrid-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f43d7-226">For more information, see [How to: Format the Windows Forms DataGrid Control](how-to-format-the-windows-forms-datagrid-control.md).</span></span>

## <a name="events"></a><span data-ttu-id="f43d7-227">事件</span><span class="sxs-lookup"><span data-stu-id="f43d7-227">Events</span></span>

<span data-ttu-id="f43d7-228">除了常见的控件事件（如 <xref:System.Windows.Forms.Control.MouseDown>、<xref:System.Windows.Forms.Control.Enter> 和 <xref:System.Windows.Forms.DataGrid.Scroll>），<xref:System.Windows.Forms.DataGrid> 控件还支持在网格内进行编辑和导航。</span><span class="sxs-lookup"><span data-stu-id="f43d7-228">Besides the common control events such as <xref:System.Windows.Forms.Control.MouseDown>, <xref:System.Windows.Forms.Control.Enter>, and <xref:System.Windows.Forms.DataGrid.Scroll>, the <xref:System.Windows.Forms.DataGrid> control supports events associated with editing and navigation within the grid.</span></span> <span data-ttu-id="f43d7-229"><xref:System.Windows.Forms.DataGrid.CurrentCell%2A> 属性用于确定选择哪个单元格。</span><span class="sxs-lookup"><span data-stu-id="f43d7-229">The <xref:System.Windows.Forms.DataGrid.CurrentCell%2A> property determines which cell is selected.</span></span> <span data-ttu-id="f43d7-230">当用户导航到新的单元格时，将引发 <xref:System.Windows.Forms.DataGrid.CurrentCellChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="f43d7-230">The <xref:System.Windows.Forms.DataGrid.CurrentCellChanged> event is raised when the user navigates to a new cell.</span></span> <span data-ttu-id="f43d7-231">当用户通过父/子关系导航到新表时，将引发 <xref:System.Windows.Forms.DataGrid.Navigate> 事件。</span><span class="sxs-lookup"><span data-stu-id="f43d7-231">When the user navigates to a new table through parent/child relations, the <xref:System.Windows.Forms.DataGrid.Navigate> event is raised.</span></span> <span data-ttu-id="f43d7-232">当用户单击后退按钮和查看子表时，将引发 <xref:System.Windows.Forms.DataGrid.BackButtonClick> 事件；当单击“显示/隐藏父行”图标时，将引发 <xref:System.Windows.Forms.DataGrid.ShowParentDetailsButtonClick> 事件。</span><span class="sxs-lookup"><span data-stu-id="f43d7-232">The <xref:System.Windows.Forms.DataGrid.BackButtonClick> event is raised when the user clicks the back button when the user is viewing a child table, and the <xref:System.Windows.Forms.DataGrid.ShowParentDetailsButtonClick> event is raised when the show/hide parent rows icon is clicked.</span></span>

## <a name="see-also"></a><span data-ttu-id="f43d7-233">另请参阅</span><span class="sxs-lookup"><span data-stu-id="f43d7-233">See also</span></span>

- [<span data-ttu-id="f43d7-234">DataGrid 控件</span><span class="sxs-lookup"><span data-stu-id="f43d7-234">DataGrid Control</span></span>](datagrid-control-windows-forms.md)
- [<span data-ttu-id="f43d7-235">如何：将 Windows 窗体 DataGrid 控件绑定到数据源</span><span class="sxs-lookup"><span data-stu-id="f43d7-235">How to: Bind the Windows Forms DataGrid Control to a Data Source</span></span>](how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)
- [<span data-ttu-id="f43d7-236">如何：向 Windows 窗体 DataGrid 控件添加表和列</span><span class="sxs-lookup"><span data-stu-id="f43d7-236">How to: Add Tables and Columns to the Windows Forms DataGrid Control</span></span>](how-to-add-tables-and-columns-to-the-windows-forms-datagrid-control.md)
- [<span data-ttu-id="f43d7-237">如何：在 Windows 窗体 DataGrid 控件中删除或隐藏列</span><span class="sxs-lookup"><span data-stu-id="f43d7-237">How to: Delete or Hide Columns in the Windows Forms DataGrid Control</span></span>](how-to-delete-or-hide-columns-in-the-windows-forms-datagrid-control.md)
- [<span data-ttu-id="f43d7-238">如何：设置 Windows 窗体 DataGrid 控件的格式</span><span class="sxs-lookup"><span data-stu-id="f43d7-238">How to: Format the Windows Forms DataGrid Control</span></span>](how-to-format-the-windows-forms-datagrid-control.md)
