---
title: BindingSource 组件体系结构
ms.date: 03/30/2017
helpviewer_keywords:
- BindingSource component [Windows Forms], architecture
- Windows Forms, data binding
- BindingSource component [Windows Forms], about BindingSource component
- data binding [Windows Forms], BindingSource component
ms.assetid: 7bc69c90-8a11-48b1-9336-3adab5b41591
ms.openlocfilehash: 54a23ba899ceb05701fe3580aefbb723c6b3f0fd
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/09/2020
ms.locfileid: "96970718"
---
# <a name="bindingsource-component-architecture"></a><span data-ttu-id="225a4-102">BindingSource 组件体系结构</span><span class="sxs-lookup"><span data-stu-id="225a4-102">BindingSource Component Architecture</span></span>
<span data-ttu-id="225a4-103">通过 <xref:System.Windows.Forms.BindingSource> 组件，可以将所有 Windows 窗体控件全局绑定到数据源。</span><span class="sxs-lookup"><span data-stu-id="225a4-103">With the <xref:System.Windows.Forms.BindingSource> component, you can universally bind  all Windows Forms controls to data sources.</span></span>  
  
 <span data-ttu-id="225a4-104">该 <xref:System.Windows.Forms.BindingSource> 组件简化了将控件绑定到数据源的过程，并且比传统的数据绑定具有以下优势：</span><span class="sxs-lookup"><span data-stu-id="225a4-104">The <xref:System.Windows.Forms.BindingSource> component simplifies the process of binding controls to a data source and provides the following advantages over traditional data binding:</span></span>  
  
- <span data-ttu-id="225a4-105">启用到业务对象的设计时绑定。</span><span class="sxs-lookup"><span data-stu-id="225a4-105">Enables design-time binding to business objects.</span></span>  
  
- <span data-ttu-id="225a4-106">封装 <xref:System.Windows.Forms.CurrencyManager> 功能，并 <xref:System.Windows.Forms.CurrencyManager> 在设计时公开事件。</span><span class="sxs-lookup"><span data-stu-id="225a4-106">Encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes <xref:System.Windows.Forms.CurrencyManager> events at design time.</span></span>  
  
- <span data-ttu-id="225a4-107"><xref:System.ComponentModel.IBindingList>通过提供对不以本机方式支持列表更改通知的数据源的列表更改通知，简化了创建支持该接口的列表的操作。</span><span class="sxs-lookup"><span data-stu-id="225a4-107">Simplifies creating a list that supports the <xref:System.ComponentModel.IBindingList> interface by providing list change notification for data sources that do not natively support list change notification.</span></span>  
  
- <span data-ttu-id="225a4-108">为方法提供一个扩展点 <xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-108">Provides an extensibility point for the <xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType> method.</span></span>  
  
- <span data-ttu-id="225a4-109">提供数据源和控件之间的间接级别。</span><span class="sxs-lookup"><span data-stu-id="225a4-109">Provides a level of indirection between the data source and the control.</span></span> <span data-ttu-id="225a4-110">当数据源在运行时可能更改时，此间接寻址非常重要。</span><span class="sxs-lookup"><span data-stu-id="225a4-110">This indirection is important when the data source may change at run time.</span></span>  
  
- <span data-ttu-id="225a4-111">与其他与数据相关的 Windows 窗体控件（特别是 <xref:System.Windows.Forms.BindingNavigator> 和控件）互操作 <xref:System.Windows.Forms.DataGridView> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-111">Interoperates with other data-related Windows Forms controls, specifically the <xref:System.Windows.Forms.BindingNavigator> and the <xref:System.Windows.Forms.DataGridView> controls.</span></span>  
  
 <span data-ttu-id="225a4-112">由于这些原因， <xref:System.Windows.Forms.BindingSource> 组件是将 Windows 窗体控件绑定到数据源的首选方法。</span><span class="sxs-lookup"><span data-stu-id="225a4-112">For these reasons, the <xref:System.Windows.Forms.BindingSource> component is the preferred way to bind your Windows Forms controls to data sources.</span></span>  
  
## <a name="bindingsource-features"></a><span data-ttu-id="225a4-113">BindingSource 功能</span><span class="sxs-lookup"><span data-stu-id="225a4-113">BindingSource Features</span></span>  
 <span data-ttu-id="225a4-114"><xref:System.Windows.Forms.BindingSource>组件提供多种功能用于将控件绑定到数据。</span><span class="sxs-lookup"><span data-stu-id="225a4-114">The <xref:System.Windows.Forms.BindingSource> component provides several features for binding controls to data.</span></span> <span data-ttu-id="225a4-115">利用这些功能，你可以实现大多数数据绑定方案，几乎不会对你的部分进行编码。</span><span class="sxs-lookup"><span data-stu-id="225a4-115">With these features, you can implement most data-binding scenarios with almost no coding on your part.</span></span>  
  
 <span data-ttu-id="225a4-116"><xref:System.Windows.Forms.BindingSource>组件通过提供用于访问多种不同类型的数据源的一致界面来实现这一点。</span><span class="sxs-lookup"><span data-stu-id="225a4-116">The <xref:System.Windows.Forms.BindingSource> component accomplishes this by providing a consistent interface for accessing many different kinds of data sources.</span></span> <span data-ttu-id="225a4-117">这意味着，可以使用相同的过程来绑定到任何类型。</span><span class="sxs-lookup"><span data-stu-id="225a4-117">This means that you use the same procedure for binding to any type.</span></span> <span data-ttu-id="225a4-118">例如，可以将 <xref:System.Windows.Forms.BindingSource.DataSource%2A> 属性附加到 <xref:System.Data.DataSet> 或业务对象，在这两种情况下，可以使用相同的一组属性、方法和事件来操作数据源。</span><span class="sxs-lookup"><span data-stu-id="225a4-118">For example, you can attach the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property to a <xref:System.Data.DataSet> or to a business object and in both cases you use the same set of properties, methods, and events to manipulate the data source.</span></span>  
  
 <span data-ttu-id="225a4-119">组件提供的一致接口 <xref:System.Windows.Forms.BindingSource> 极大地简化了将数据绑定到控件的过程。</span><span class="sxs-lookup"><span data-stu-id="225a4-119">The consistent interface provided by the <xref:System.Windows.Forms.BindingSource> component greatly simplifies the process of binding data to controls.</span></span> <span data-ttu-id="225a4-120">对于提供更改通知的数据源类型，该 <xref:System.Windows.Forms.BindingSource> 组件会自动传达控件和数据源之间的更改。</span><span class="sxs-lookup"><span data-stu-id="225a4-120">For data-source types that provide change notification, the <xref:System.Windows.Forms.BindingSource> component automatically communicates changes between the control and the data source.</span></span> <span data-ttu-id="225a4-121">对于不提供更改通知的数据源类型，将提供事件，使你能够引发更改通知。</span><span class="sxs-lookup"><span data-stu-id="225a4-121">For data-source types that do not provide change notification, events are provided that let you raise change notifications.</span></span> <span data-ttu-id="225a4-122">以下列表显示了该组件支持的功能 <xref:System.Windows.Forms.BindingSource> ：</span><span class="sxs-lookup"><span data-stu-id="225a4-122">The following list shows the features supported by the <xref:System.Windows.Forms.BindingSource> component:</span></span>  
  
- <span data-ttu-id="225a4-123">二级.</span><span class="sxs-lookup"><span data-stu-id="225a4-123">Indirection.</span></span>  
  
- <span data-ttu-id="225a4-124">货币管理。</span><span class="sxs-lookup"><span data-stu-id="225a4-124">Currency management.</span></span>  
  
- <span data-ttu-id="225a4-125">作为列表的数据源。</span><span class="sxs-lookup"><span data-stu-id="225a4-125">Data source as a list.</span></span>  
  
- <span data-ttu-id="225a4-126"><xref:System.Windows.Forms.BindingSource> 用作 <xref:System.ComponentModel.IBindingList> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-126"><xref:System.Windows.Forms.BindingSource> as an <xref:System.ComponentModel.IBindingList>.</span></span>  
  
- <span data-ttu-id="225a4-127">自定义项创建。</span><span class="sxs-lookup"><span data-stu-id="225a4-127">Custom item creation.</span></span>  
  
- <span data-ttu-id="225a4-128">事务性项创建。</span><span class="sxs-lookup"><span data-stu-id="225a4-128">Transactional item creation.</span></span>  
  
- <span data-ttu-id="225a4-129"><xref:System.Collections.IEnumerable> 支持.</span><span class="sxs-lookup"><span data-stu-id="225a4-129"><xref:System.Collections.IEnumerable> support.</span></span>  
  
- <span data-ttu-id="225a4-130">设计时支持。</span><span class="sxs-lookup"><span data-stu-id="225a4-130">Design-time support.</span></span>  
  
- <span data-ttu-id="225a4-131">静态 <xref:System.Windows.Forms.ListBindingHelper> 方法。</span><span class="sxs-lookup"><span data-stu-id="225a4-131">Static <xref:System.Windows.Forms.ListBindingHelper> methods.</span></span>  
  
- <span data-ttu-id="225a4-132">用接口进行排序和筛选 <xref:System.ComponentModel.IBindingListView> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-132">Sorting and filtering with the <xref:System.ComponentModel.IBindingListView> interface.</span></span>  
  
- <span data-ttu-id="225a4-133">与集成 <xref:System.Windows.Forms.BindingNavigator> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-133">Integration with <xref:System.Windows.Forms.BindingNavigator>.</span></span>  
  
### <a name="indirection"></a><span data-ttu-id="225a4-134">间接寻址</span><span class="sxs-lookup"><span data-stu-id="225a4-134">Indirection</span></span>  
 <span data-ttu-id="225a4-135"><xref:System.Windows.Forms.BindingSource>组件提供控件和数据源之间的间接级别。</span><span class="sxs-lookup"><span data-stu-id="225a4-135">The <xref:System.Windows.Forms.BindingSource> component provides a level of indirection between a control and a data source.</span></span> <span data-ttu-id="225a4-136">将控件绑定到数据源，而不是直接将控件绑定到数据源， <xref:System.Windows.Forms.BindingSource> 并将数据源附加到 <xref:System.Windows.Forms.BindingSource> 组件的 <xref:System.Windows.Forms.BindingSource.DataSource%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="225a4-136">Instead of binding a control directly to a data source, you bind the control to a <xref:System.Windows.Forms.BindingSource>, and you attach the data source to the <xref:System.Windows.Forms.BindingSource> component's <xref:System.Windows.Forms.BindingSource.DataSource%2A> property.</span></span>  
  
 <span data-ttu-id="225a4-137">通过此级别的间接寻址，你可以更改数据源，而无需重置控件绑定。</span><span class="sxs-lookup"><span data-stu-id="225a4-137">With this level of indirection, you can change the data source without resetting the control binding.</span></span> <span data-ttu-id="225a4-138">这为你提供了以下功能：</span><span class="sxs-lookup"><span data-stu-id="225a4-138">This gives you the following capabilities:</span></span>  
  
- <span data-ttu-id="225a4-139">您可以附加 <xref:System.Windows.Forms.BindingSource> 到不同的数据源，同时保留当前控件绑定。</span><span class="sxs-lookup"><span data-stu-id="225a4-139">You can attach the <xref:System.Windows.Forms.BindingSource> to different data sources while retaining the current control bindings.</span></span>  
  
- <span data-ttu-id="225a4-140">您可以更改数据源中的项和通知绑定控件。</span><span class="sxs-lookup"><span data-stu-id="225a4-140">You can change items in the data source and notify bound controls.</span></span> <span data-ttu-id="225a4-141">有关详细信息，请参阅 [如何：使用 BindingSource 在 Windows 窗体控件中反映数据源更新](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="225a4-141">For more information, see [How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md).</span></span>  
  
- <span data-ttu-id="225a4-142">可以 <xref:System.Type> 在内存中绑定到而不是对象。</span><span class="sxs-lookup"><span data-stu-id="225a4-142">You can bind to a <xref:System.Type> instead of an object in memory.</span></span> <span data-ttu-id="225a4-143">有关详细信息，请参阅 [如何：将 Windows 窗体控件绑定到类型](how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="225a4-143">For more information, see [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md).</span></span> <span data-ttu-id="225a4-144">然后，你可以在运行时绑定到对象。</span><span class="sxs-lookup"><span data-stu-id="225a4-144">You can then bind to an object at run time.</span></span>  
  
### <a name="currency-management"></a><span data-ttu-id="225a4-145">货币管理</span><span class="sxs-lookup"><span data-stu-id="225a4-145">Currency Management</span></span>  
 <span data-ttu-id="225a4-146"><xref:System.Windows.Forms.BindingSource>组件实现 <xref:System.Windows.Forms.ICurrencyManagerProvider> 接口以处理货币管理。</span><span class="sxs-lookup"><span data-stu-id="225a4-146">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface to handle currency management for you.</span></span> <span data-ttu-id="225a4-147">使用 <xref:System.Windows.Forms.ICurrencyManagerProvider> 接口，还可以访问的的 " <xref:System.Windows.Forms.BindingSource> 除" 之外的其他绑定到 "其他" 的 "货币经理" <xref:System.Windows.Forms.BindingSource> <xref:System.Windows.Forms.BindingSource.DataMember%2A> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-147">With the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface, you can also access to the currency manager for a <xref:System.Windows.Forms.BindingSource>, in addition to the currency manager for another <xref:System.Windows.Forms.BindingSource> bound to the same <xref:System.Windows.Forms.BindingSource.DataMember%2A>.</span></span>  
  
 <span data-ttu-id="225a4-148"><xref:System.Windows.Forms.BindingSource>组件封装 <xref:System.Windows.Forms.CurrencyManager> 功能并公开最常见的 <xref:System.Windows.Forms.CurrencyManager> 属性和事件。</span><span class="sxs-lookup"><span data-stu-id="225a4-148">The <xref:System.Windows.Forms.BindingSource> component encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes the most common <xref:System.Windows.Forms.CurrencyManager> properties and events.</span></span> <span data-ttu-id="225a4-149">下表描述了与货币管理相关的一些成员。</span><span class="sxs-lookup"><span data-stu-id="225a4-149">The following table describes some of the members related to currency management.</span></span>  
  
 <span data-ttu-id="225a4-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> property</span></span>  
 <span data-ttu-id="225a4-151">获取与关联的货币管理器 <xref:System.Windows.Forms.BindingSource> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-151">Gets the currency manager associated with the <xref:System.Windows.Forms.BindingSource>.</span></span>  
  
 <span data-ttu-id="225a4-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="225a4-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> method</span></span>  
 <span data-ttu-id="225a4-153">如果有另一个 <xref:System.Windows.Forms.BindingSource> 绑定到指定的数据成员，则获取其 "货币经理"。</span><span class="sxs-lookup"><span data-stu-id="225a4-153">If there is another <xref:System.Windows.Forms.BindingSource> bound to the specified data member, gets its currency manager.</span></span>  
  
 <span data-ttu-id="225a4-154"><xref:System.Windows.Forms.BindingSource.Current%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-154"><xref:System.Windows.Forms.BindingSource.Current%2A> property</span></span>  
 <span data-ttu-id="225a4-155">获取数据源的当前项。</span><span class="sxs-lookup"><span data-stu-id="225a4-155">Gets the current item of the data source.</span></span>  
  
 <span data-ttu-id="225a4-156"><xref:System.Windows.Forms.BindingSource.Position%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-156"><xref:System.Windows.Forms.BindingSource.Position%2A> property</span></span>  
 <span data-ttu-id="225a4-157">获取或设置基础列表中的当前位置。</span><span class="sxs-lookup"><span data-stu-id="225a4-157">Gets or sets the current position in the underlying list.</span></span>  
  
 <span data-ttu-id="225a4-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="225a4-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> method</span></span>  
 <span data-ttu-id="225a4-159">将挂起的更改应用于基础数据源。</span><span class="sxs-lookup"><span data-stu-id="225a4-159">Applies pending changes to the underlying data source.</span></span>  
  
 <span data-ttu-id="225a4-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="225a4-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> method</span></span>  
 <span data-ttu-id="225a4-161">取消当前的编辑操作。</span><span class="sxs-lookup"><span data-stu-id="225a4-161">Cancels the current edit operation.</span></span>  
  
### <a name="data-source-as-a-list"></a><span data-ttu-id="225a4-162">作为列表的数据源</span><span class="sxs-lookup"><span data-stu-id="225a4-162">Data Source as a List</span></span>  
 <span data-ttu-id="225a4-163"><xref:System.Windows.Forms.BindingSource>组件实现 <xref:System.ComponentModel.IBindingListView> 和 <xref:System.ComponentModel.ITypedList> 接口。</span><span class="sxs-lookup"><span data-stu-id="225a4-163">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> and <xref:System.ComponentModel.ITypedList> interfaces.</span></span> <span data-ttu-id="225a4-164">使用此实现，你可以使用 <xref:System.Windows.Forms.BindingSource> 组件本身作为数据源，而无需任何外部存储。</span><span class="sxs-lookup"><span data-stu-id="225a4-164">With this implementation, you can use the <xref:System.Windows.Forms.BindingSource> component itself as a data source, without any external storage.</span></span>  
  
 <span data-ttu-id="225a4-165">当 <xref:System.Windows.Forms.BindingSource> 组件附加到数据源时，它会将数据源作为列表公开。</span><span class="sxs-lookup"><span data-stu-id="225a4-165">When the <xref:System.Windows.Forms.BindingSource> component is attached to a data source, it exposes the data source as a list.</span></span>  
  
 <span data-ttu-id="225a4-166"><xref:System.Windows.Forms.BindingSource.DataSource%2A>属性可设置为多个数据源。</span><span class="sxs-lookup"><span data-stu-id="225a4-166">The <xref:System.Windows.Forms.BindingSource.DataSource%2A> property can be set to several data sources.</span></span> <span data-ttu-id="225a4-167">其中包括类型、对象和类型列表。</span><span class="sxs-lookup"><span data-stu-id="225a4-167">These include types, objects, and lists of types.</span></span> <span data-ttu-id="225a4-168">生成的数据源将作为列表公开。</span><span class="sxs-lookup"><span data-stu-id="225a4-168">The resulting data source will be exposed as a list.</span></span> <span data-ttu-id="225a4-169">下表显示了一些常用数据源和生成的列表计算。</span><span class="sxs-lookup"><span data-stu-id="225a4-169">The following table shows some of the common data sources and the resulting list evaluation.</span></span>  
  
|<span data-ttu-id="225a4-170">DataSource 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-170">DataSource property</span></span>|<span data-ttu-id="225a4-171">列出结果</span><span class="sxs-lookup"><span data-stu-id="225a4-171">List results</span></span>|  
|-------------------------|------------------|  
|<span data-ttu-id="225a4-172">空引用（在 Visual Basic 中为 `Nothing`）</span><span class="sxs-lookup"><span data-stu-id="225a4-172">A null reference (`Nothing` in Visual Basic)</span></span>|<span data-ttu-id="225a4-173">对象的空 <xref:System.ComponentModel.IBindingList> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-173">An empty <xref:System.ComponentModel.IBindingList> of objects.</span></span> <span data-ttu-id="225a4-174">添加项会将列表设置为所添加项的类型。</span><span class="sxs-lookup"><span data-stu-id="225a4-174">Adding an item sets the list to the type of the added item.</span></span>|  
|<span data-ttu-id="225a4-175">`Nothing`具有 set 的 Visual Basic) 中 (空 <xref:System.Windows.Forms.BindingSource.DataMember%2A> 引用</span><span class="sxs-lookup"><span data-stu-id="225a4-175">A null reference (`Nothing` in Visual Basic) with <xref:System.Windows.Forms.BindingSource.DataMember%2A> set</span></span>|<span data-ttu-id="225a4-176">不受支持;引发 <xref:System.ArgumentException> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-176">Not supported; raises <xref:System.ArgumentException>.</span></span>|  
|<span data-ttu-id="225a4-177">"T" 类型的非列表类型或对象</span><span class="sxs-lookup"><span data-stu-id="225a4-177">Non-list type or object of type "T"</span></span>|<span data-ttu-id="225a4-178">类型为 <xref:System.ComponentModel.IBindingList> "T" 的空。</span><span class="sxs-lookup"><span data-stu-id="225a4-178">An empty <xref:System.ComponentModel.IBindingList> of type "T".</span></span>|  
|<span data-ttu-id="225a4-179">数组实例</span><span class="sxs-lookup"><span data-stu-id="225a4-179">Array instance</span></span>|<span data-ttu-id="225a4-180">一个 <xref:System.ComponentModel.IBindingList> 包含数组元素的。</span><span class="sxs-lookup"><span data-stu-id="225a4-180">An <xref:System.ComponentModel.IBindingList> containing the array elements.</span></span>|  
|<span data-ttu-id="225a4-181"><xref:System.Collections.IEnumerable> 实例</span><span class="sxs-lookup"><span data-stu-id="225a4-181"><xref:System.Collections.IEnumerable> instance</span></span>|<span data-ttu-id="225a4-182">一个 <xref:System.ComponentModel.IBindingList> 包含 <xref:System.Collections.IEnumerable> 项的</span><span class="sxs-lookup"><span data-stu-id="225a4-182">An <xref:System.ComponentModel.IBindingList> containing the <xref:System.Collections.IEnumerable> items</span></span>|  
|<span data-ttu-id="225a4-183">包含类型 "T" 的列表实例</span><span class="sxs-lookup"><span data-stu-id="225a4-183">List instance containing type "T"</span></span>|<span data-ttu-id="225a4-184">一个 <xref:System.ComponentModel.IBindingList> 包含类型 "T" 的实例。</span><span class="sxs-lookup"><span data-stu-id="225a4-184">An <xref:System.ComponentModel.IBindingList> instance containing type "T".</span></span>|  
  
 <span data-ttu-id="225a4-185">此外，还 <xref:System.Windows.Forms.BindingSource.DataSource%2A> 可以设置为其他列表类型（例如 <xref:System.ComponentModel.IListSource> 和）， <xref:System.ComponentModel.ITypedList> 并且 <xref:System.Windows.Forms.BindingSource> 会相应地处理它们。</span><span class="sxs-lookup"><span data-stu-id="225a4-185">Additionally, <xref:System.Windows.Forms.BindingSource.DataSource%2A> can be set to other list types, such as <xref:System.ComponentModel.IListSource> and <xref:System.ComponentModel.ITypedList>, and the <xref:System.Windows.Forms.BindingSource> will handle them appropriately.</span></span> <span data-ttu-id="225a4-186">在这种情况下，列表中包含的类型应具有一个无参数的构造函数。</span><span class="sxs-lookup"><span data-stu-id="225a4-186">In this case, the type that is contained in the list should have a parameterless constructor.</span></span>  
  
### <a name="bindingsource-as-an-ibindinglist"></a><span data-ttu-id="225a4-187">BindingSource 作为 IBindingList</span><span class="sxs-lookup"><span data-stu-id="225a4-187">BindingSource as an IBindingList</span></span>  
 <span data-ttu-id="225a4-188"><xref:System.Windows.Forms.BindingSource>组件提供用于访问基础数据并将其操作为的成员 <xref:System.ComponentModel.IBindingList> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-188">The <xref:System.Windows.Forms.BindingSource> component provides members for accessing and manipulating the underlying data as an <xref:System.ComponentModel.IBindingList>.</span></span> <span data-ttu-id="225a4-189">下表对其中一些成员进行了说明。</span><span class="sxs-lookup"><span data-stu-id="225a4-189">The following table describes some of these members.</span></span>  
  
|<span data-ttu-id="225a4-190">成员</span><span class="sxs-lookup"><span data-stu-id="225a4-190">Member</span></span>|<span data-ttu-id="225a4-191">描述</span><span class="sxs-lookup"><span data-stu-id="225a4-191">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="225a4-192"><xref:System.Windows.Forms.BindingSource.List%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-192"><xref:System.Windows.Forms.BindingSource.List%2A> property</span></span>|<span data-ttu-id="225a4-193">获取或属性的计算结果的列表 <xref:System.Windows.Forms.BindingSource.DataSource%2A> <xref:System.Windows.Forms.BindingSource.DataMember%2A> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-193">Gets the list that results from the evaluation of the <xref:System.Windows.Forms.BindingSource.DataSource%2A> or <xref:System.Windows.Forms.BindingSource.DataMember%2A> properties.</span></span>|  
|<span data-ttu-id="225a4-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="225a4-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> method</span></span>|<span data-ttu-id="225a4-195">在基础列表中添加一个新项。</span><span class="sxs-lookup"><span data-stu-id="225a4-195">Adds a new item to the underlying list.</span></span> <span data-ttu-id="225a4-196">适用于实现 <xref:System.ComponentModel.IBindingList> 接口并允许添加项的数据源 (即， <xref:System.Windows.Forms.BindingSource.AllowNew%2A> 属性设置为 `true`) 。</span><span class="sxs-lookup"><span data-stu-id="225a4-196">Applies to data sources that implement the <xref:System.ComponentModel.IBindingList> interface and allow adding items (that is, the <xref:System.Windows.Forms.BindingSource.AllowNew%2A> property is set to `true`).</span></span>|  
  
### <a name="custom-item-creation"></a><span data-ttu-id="225a4-197">自定义项创建</span><span class="sxs-lookup"><span data-stu-id="225a4-197">Custom Item Creation</span></span>  
 <span data-ttu-id="225a4-198">您可以处理 <xref:System.Windows.Forms.BindingSource.AddingNew> 事件以提供您自己的项创建逻辑。</span><span class="sxs-lookup"><span data-stu-id="225a4-198">You can handle the <xref:System.Windows.Forms.BindingSource.AddingNew> event to provide your own item-creation logic.</span></span> <span data-ttu-id="225a4-199"><xref:System.Windows.Forms.BindingSource.AddingNew>事件发生在将新对象添加到之前 <xref:System.Windows.Forms.BindingSource> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-199">The <xref:System.Windows.Forms.BindingSource.AddingNew> event occurs before a new object is added to the <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="225a4-200"><xref:System.Windows.Forms.BindingSource.AddNew%2A>调用方法后，但在将新项添加到基础列表之前，将引发此事件。</span><span class="sxs-lookup"><span data-stu-id="225a4-200">This event is raised after the <xref:System.Windows.Forms.BindingSource.AddNew%2A> method is called, but before the new item is added to the underlying list.</span></span> <span data-ttu-id="225a4-201">通过处理此事件，你可以提供自定义项创建行为，而无需从 <xref:System.Windows.Forms.BindingSource> 类派生。</span><span class="sxs-lookup"><span data-stu-id="225a4-201">By handling this event, you can provide custom item creation behavior without deriving from the <xref:System.Windows.Forms.BindingSource> class.</span></span> <span data-ttu-id="225a4-202">有关详细信息，请参阅 [如何：自定义带有 Windows 窗体 BindingSource 的项添加操作](how-to-customize-item-addition-with-the-windows-forms-bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="225a4-202">For more information, see [How to: Customize Item Addition with the Windows Forms BindingSource](how-to-customize-item-addition-with-the-windows-forms-bindingsource.md).</span></span>  
  
### <a name="transactional-item-creation"></a><span data-ttu-id="225a4-203">事务项创建</span><span class="sxs-lookup"><span data-stu-id="225a4-203">Transactional Item Creation</span></span>  
 <span data-ttu-id="225a4-204"><xref:System.Windows.Forms.BindingSource>组件实现了 <xref:System.ComponentModel.ICancelAddNew> 接口，该接口启用事务项创建。</span><span class="sxs-lookup"><span data-stu-id="225a4-204">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.ICancelAddNew> interface, which enables transactional item creation.</span></span> <span data-ttu-id="225a4-205">使用调用暂时创建新项后 <xref:System.Windows.Forms.BindingSource.AddNew%2A> ，可以通过以下方式提交或回滚添加操作：</span><span class="sxs-lookup"><span data-stu-id="225a4-205">After a new item is provisionally created by using a call to <xref:System.Windows.Forms.BindingSource.AddNew%2A>, the addition may be committed or rolled back in the following ways:</span></span>  
  
- <span data-ttu-id="225a4-206"><xref:System.ComponentModel.ICancelAddNew.EndNew%2A>方法将显式提交挂起的添加。</span><span class="sxs-lookup"><span data-stu-id="225a4-206">The <xref:System.ComponentModel.ICancelAddNew.EndNew%2A> method will explicitly commit the pending addition.</span></span>  
  
- <span data-ttu-id="225a4-207">执行其他集合操作（如插入、删除或移动）将隐式提交挂起的添加操作。</span><span class="sxs-lookup"><span data-stu-id="225a4-207">Performing another collection operation, such as an insertion, removal, or move, will implicitly commit the pending addition.</span></span>  
  
- <span data-ttu-id="225a4-208"><xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>如果尚未提交方法，则方法将回滚挂起的添加。</span><span class="sxs-lookup"><span data-stu-id="225a4-208">The <xref:System.ComponentModel.ICancelAddNew.CancelNew%2A> method will roll back the pending addition if the method has not already been committed.</span></span>  
  
### <a name="ienumerable-support"></a><span data-ttu-id="225a4-209">IEnumerable 支持</span><span class="sxs-lookup"><span data-stu-id="225a4-209">IEnumerable Support</span></span>  
 <span data-ttu-id="225a4-210"><xref:System.Windows.Forms.BindingSource>组件启用将控件绑定到 <xref:System.Collections.IEnumerable> 数据源。</span><span class="sxs-lookup"><span data-stu-id="225a4-210">The <xref:System.Windows.Forms.BindingSource> component enables binding controls to <xref:System.Collections.IEnumerable> data sources.</span></span> <span data-ttu-id="225a4-211">使用此组件，可以绑定到数据源，例如 <xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-211">With this component, you can bind to a data source such as a <xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="225a4-212">将 <xref:System.Collections.IEnumerable> 数据源分配给 <xref:System.Windows.Forms.BindingSource> 组件时，会 <xref:System.Windows.Forms.BindingSource> 创建一个 <xref:System.ComponentModel.IBindingList> ，并将数据源的内容添加 <xref:System.Collections.IEnumerable> 到列表。</span><span class="sxs-lookup"><span data-stu-id="225a4-212">When an <xref:System.Collections.IEnumerable> data source is assigned to the <xref:System.Windows.Forms.BindingSource> component, the <xref:System.Windows.Forms.BindingSource> creates an <xref:System.ComponentModel.IBindingList> and adds the contents of the <xref:System.Collections.IEnumerable> data source to the list.</span></span>  
  
### <a name="design-time-support"></a><span data-ttu-id="225a4-213">Design-Time 支持</span><span class="sxs-lookup"><span data-stu-id="225a4-213">Design-Time Support</span></span>  
 <span data-ttu-id="225a4-214">某些对象类型无法在设计时创建，例如从工厂类创建的对象，或 Web 服务返回的对象。</span><span class="sxs-lookup"><span data-stu-id="225a4-214">Some object types cannot be created at design time, such as objects created from a factory class, or objects returned by a Web service.</span></span> <span data-ttu-id="225a4-215">有时，你可能需要在设计时将控件绑定到这些类型，即使控件可以绑定到的内存中没有对象。</span><span class="sxs-lookup"><span data-stu-id="225a4-215">You may sometimes have to bind your controls to these types at design time, even though there is no object in memory to which your controls can bind.</span></span> <span data-ttu-id="225a4-216">例如，你可能需要 <xref:System.Windows.Forms.DataGridView> 使用自定义类型的公共属性的名称来标记控件的列标题。</span><span class="sxs-lookup"><span data-stu-id="225a4-216">You may, for example, need to label the column headers of a <xref:System.Windows.Forms.DataGridView> control with the names of your custom type's public properties.</span></span>  
  
 <span data-ttu-id="225a4-217">若要支持此方案， <xref:System.Windows.Forms.BindingSource> 组件支持绑定到 <xref:System.Type> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-217">To support this scenario, the <xref:System.Windows.Forms.BindingSource> component supports binding to a <xref:System.Type>.</span></span> <span data-ttu-id="225a4-218">将分配 <xref:System.Type> 到 <xref:System.Windows.Forms.BindingSource.DataSource%2A> 属性时， <xref:System.Windows.Forms.BindingSource> 组件会创建一个空 <xref:System.ComponentModel.BindingList%601> 的 <xref:System.Type> 项。</span><span class="sxs-lookup"><span data-stu-id="225a4-218">When you assign a <xref:System.Type> to the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property, the <xref:System.Windows.Forms.BindingSource> component creates an empty <xref:System.ComponentModel.BindingList%601> of <xref:System.Type> items.</span></span> <span data-ttu-id="225a4-219">以后绑定到组件的任何控件 <xref:System.Windows.Forms.BindingSource> 将在设计时或运行时向你发出类型属性或架构的警报。</span><span class="sxs-lookup"><span data-stu-id="225a4-219">Any controls you subsequently bind to the <xref:System.Windows.Forms.BindingSource> component will be alerted to the presence of the properties or schema of your type at design time, or at run time.</span></span> <span data-ttu-id="225a4-220">有关详细信息，请参阅 [如何：将 Windows 窗体控件绑定到类型](how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="225a4-220">For more information, see [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md).</span></span>  
  
### <a name="static-listbindinghelper-methods"></a><span data-ttu-id="225a4-221">静态 ListBindingHelper 方法</span><span class="sxs-lookup"><span data-stu-id="225a4-221">Static ListBindingHelper Methods</span></span>  
 <span data-ttu-id="225a4-222"><xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>、 <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType> 和 <xref:System.Windows.Forms.BindingSource> 类型都共享公共逻辑，以便从对中生成列表 `DataSource` / `DataMember` 。</span><span class="sxs-lookup"><span data-stu-id="225a4-222">The <xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>, <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>, and <xref:System.Windows.Forms.BindingSource> types all share common logic to generate a list from a `DataSource`/`DataMember` pair.</span></span> <span data-ttu-id="225a4-223">此外，在以下方法中，将公开此公共逻辑以供控件作者和其他第三方使用 `static` ：</span><span class="sxs-lookup"><span data-stu-id="225a4-223">Additionally, this common logic is publicly exposed for use by control authors and other third parties in the following `static` methods:</span></span>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListItemProperties%2A>  
  
- <span data-ttu-id="225a4-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span><span class="sxs-lookup"><span data-stu-id="225a4-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span></span>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListName%2A>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListItemType%2A>  
  
### <a name="sorting-and-filtering-with-the-ibindinglistview-interface"></a><span data-ttu-id="225a4-225">通过 IBindingListView 接口进行排序和筛选</span><span class="sxs-lookup"><span data-stu-id="225a4-225">Sorting and Filtering with the IBindingListView Interface</span></span>  
 <span data-ttu-id="225a4-226"><xref:System.Windows.Forms.BindingSource>组件实现 <xref:System.ComponentModel.IBindingListView> 接口，该接口用于扩展 <xref:System.ComponentModel.IBindingList> 接口。</span><span class="sxs-lookup"><span data-stu-id="225a4-226">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> interface, which extends the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="225a4-227"><xref:System.ComponentModel.IBindingList>提供单个列排序，并 <xref:System.ComponentModel.IBindingListView> 提供高级排序和筛选功能。</span><span class="sxs-lookup"><span data-stu-id="225a4-227">The <xref:System.ComponentModel.IBindingList> offers single column sorting and the <xref:System.ComponentModel.IBindingListView> offers advanced sorting and filtering.</span></span> <span data-ttu-id="225a4-228">对于 <xref:System.ComponentModel.IBindingListView> ，如果数据源还实现其中一个接口，则可以对数据源中的项进行排序和筛选。</span><span class="sxs-lookup"><span data-stu-id="225a4-228">With <xref:System.ComponentModel.IBindingListView>, you can sort and filter items in the data source, if the data source also implements one of these interfaces.</span></span> <span data-ttu-id="225a4-229">该 <xref:System.Windows.Forms.BindingSource> 组件不提供这些成员的引用实现。</span><span class="sxs-lookup"><span data-stu-id="225a4-229">The <xref:System.Windows.Forms.BindingSource> component does not provide a reference implementation of these members.</span></span> <span data-ttu-id="225a4-230">而是将调用转发到基础列表。</span><span class="sxs-lookup"><span data-stu-id="225a4-230">Instead, calls are forwarded to the underlying list.</span></span>  
  
 <span data-ttu-id="225a4-231">下表描述了用于排序和筛选的属性。</span><span class="sxs-lookup"><span data-stu-id="225a4-231">The following table describes the properties you use for sorting and filtering.</span></span>  
  
|<span data-ttu-id="225a4-232">成员</span><span class="sxs-lookup"><span data-stu-id="225a4-232">Member</span></span>|<span data-ttu-id="225a4-233">描述</span><span class="sxs-lookup"><span data-stu-id="225a4-233">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="225a4-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> property</span></span>|<span data-ttu-id="225a4-235">如果数据源是 <xref:System.ComponentModel.IBindingListView>，则获取或设置用于筛选已查看的行的表达式。</span><span class="sxs-lookup"><span data-stu-id="225a4-235">If the data source is an <xref:System.ComponentModel.IBindingListView>, gets or sets the expression used to filter which rows are viewed.</span></span>|  
|<span data-ttu-id="225a4-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> 属性</span><span class="sxs-lookup"><span data-stu-id="225a4-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> property</span></span>|<span data-ttu-id="225a4-237">如果数据源是 <xref:System.ComponentModel.IBindingList>，则获取或设置用于排序的列名称并对顺序信息进行排序。</span><span class="sxs-lookup"><span data-stu-id="225a4-237">If the data source is an <xref:System.ComponentModel.IBindingList>, gets or sets a column name used for sorting and sort order information.</span></span><br /><br /> <span data-ttu-id="225a4-238">-或-</span><span class="sxs-lookup"><span data-stu-id="225a4-238">-or-</span></span><br /><br /> <span data-ttu-id="225a4-239">如果数据源是 <xref:System.ComponentModel.IBindingListView> 并支持高级排序，则获取用于排序和排序顺序的多个列名</span><span class="sxs-lookup"><span data-stu-id="225a4-239">If the data source is an <xref:System.ComponentModel.IBindingListView> and supports advanced sorting, gets multiple column names used for sorting and sort order</span></span>|  
  
### <a name="integration-with-bindingnavigator"></a><span data-ttu-id="225a4-240">与 BindingNavigator 集成</span><span class="sxs-lookup"><span data-stu-id="225a4-240">Integration with BindingNavigator</span></span>  
 <span data-ttu-id="225a4-241">您可以使用该 <xref:System.Windows.Forms.BindingSource> 组件将任何 Windows 窗体控件绑定到数据源，但该 <xref:System.Windows.Forms.BindingNavigator> 控件专门设计用于处理该 <xref:System.Windows.Forms.BindingSource> 组件。</span><span class="sxs-lookup"><span data-stu-id="225a4-241">You can use the <xref:System.Windows.Forms.BindingSource> component to bind any Windows Forms control to a data source, but the <xref:System.Windows.Forms.BindingNavigator> control is designed specifically to work with the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="225a4-242"><xref:System.Windows.Forms.BindingNavigator>控件提供用于控制 <xref:System.Windows.Forms.BindingSource> 组件当前项的用户界面。</span><span class="sxs-lookup"><span data-stu-id="225a4-242">The <xref:System.Windows.Forms.BindingNavigator> control provides a user interface for controlling the <xref:System.Windows.Forms.BindingSource> component's current item.</span></span> <span data-ttu-id="225a4-243">默认情况下， <xref:System.Windows.Forms.BindingNavigator> 控件提供与组件上的导航方法相对应的按钮 <xref:System.Windows.Forms.BindingSource> 。</span><span class="sxs-lookup"><span data-stu-id="225a4-243">By default, the <xref:System.Windows.Forms.BindingNavigator> control provides buttons that correspond to the navigation methods on the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="225a4-244">有关详细信息，请参阅 [如何：用 Windows 窗体 BindingNavigator 控件浏览数据](how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md)。</span><span class="sxs-lookup"><span data-stu-id="225a4-244">For more information, see [How to: Navigate Data with the Windows Forms BindingNavigator Control](how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="225a4-245">另请参阅</span><span class="sxs-lookup"><span data-stu-id="225a4-245">See also</span></span>

- <xref:System.Windows.Forms.BindingSource>
- <xref:System.Windows.Forms.BindingNavigator>
- [<span data-ttu-id="225a4-246">BindingSource 组件概述</span><span class="sxs-lookup"><span data-stu-id="225a4-246">BindingSource Component Overview</span></span>](bindingsource-component-overview.md)
- [<span data-ttu-id="225a4-247">BindingNavigator 控件</span><span class="sxs-lookup"><span data-stu-id="225a4-247">BindingNavigator Control</span></span>](bindingnavigator-control-windows-forms.md)
- [<span data-ttu-id="225a4-248">Windows 窗体数据绑定</span><span class="sxs-lookup"><span data-stu-id="225a4-248">Windows Forms Data Binding</span></span>](../windows-forms-data-binding.md)
- [<span data-ttu-id="225a4-249">在 Windows 窗体上使用的控件</span><span class="sxs-lookup"><span data-stu-id="225a4-249">Controls to Use on Windows Forms</span></span>](controls-to-use-on-windows-forms.md)
- [<span data-ttu-id="225a4-250">如何：将 Windows 窗体控件绑定到类型</span><span class="sxs-lookup"><span data-stu-id="225a4-250">How to: Bind a Windows Forms Control to a Type</span></span>](how-to-bind-a-windows-forms-control-to-a-type.md)
- [<span data-ttu-id="225a4-251">如何：使用 BindingSource 在 Windows 窗体控件中反映数据源更新</span><span class="sxs-lookup"><span data-stu-id="225a4-251">How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource</span></span>](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)
