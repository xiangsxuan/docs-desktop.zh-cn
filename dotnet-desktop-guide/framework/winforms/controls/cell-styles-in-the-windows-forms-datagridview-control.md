---
title: DataGridView 控件中的单元格样式
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], cell styles
- cells [Windows Forms], styles
- data grids [Windows Forms], cell styles
ms.assetid: dbb75ed6-8804-4232-8382-f9920c2e380c
ms.openlocfilehash: fe56033a5adbe7719c64695c8f9ebc4f3644fc65
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/09/2020
ms.locfileid: "96971556"
---
# <a name="cell-styles-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="0c289-102">Windows 窗体 DataGridView 控件中的单元格样式</span><span class="sxs-lookup"><span data-stu-id="0c289-102">Cell Styles in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="0c289-103">控件中的每个单元格都 <xref:System.Windows.Forms.DataGridView> 可以有自己的样式，如文本格式、背景色、前景色和字体。</span><span class="sxs-lookup"><span data-stu-id="0c289-103">Each cell within the <xref:System.Windows.Forms.DataGridView> control can have its own style, such as text format, background color, foreground color, and font.</span></span> <span data-ttu-id="0c289-104">不过，通常情况下，多个单元格将共享特定的样式特征。</span><span class="sxs-lookup"><span data-stu-id="0c289-104">Typically, however, multiple cells will share particular style characteristics.</span></span>  
  
 <span data-ttu-id="0c289-105">共享样式的单元格组可以包含特定行或列中的所有单元格、包含特定值的所有单元格或控件中的所有单元格。</span><span class="sxs-lookup"><span data-stu-id="0c289-105">Groups of cells that share styles may include all cells within particular rows or columns, all cells that contain particular values, or all cells in the control.</span></span> <span data-ttu-id="0c289-106">由于这些组重叠，因此每个单元格可能会从多个位置获取其样式信息。</span><span class="sxs-lookup"><span data-stu-id="0c289-106">Because these groups overlap, each cell may get its styling information from more than one place.</span></span> <span data-ttu-id="0c289-107">例如，您可能想要控件中的每个单元格都 <xref:System.Windows.Forms.DataGridView> 使用同一字体，但只有货币列中的单元格使用货币格式，而只有包含负数的货币单元格才能使用红色前景色。</span><span class="sxs-lookup"><span data-stu-id="0c289-107">For example, you may want every cell in a <xref:System.Windows.Forms.DataGridView> control to use the same font, but only cells in currency columns to use currency format, and only currency cells with negative numbers to use a red foreground color.</span></span>  
  
## <a name="the-datagridviewcellstyle-class"></a><span data-ttu-id="0c289-108">DataGridViewCellStyle 类</span><span class="sxs-lookup"><span data-stu-id="0c289-108">The DataGridViewCellStyle Class</span></span>  
 <span data-ttu-id="0c289-109"><xref:System.Windows.Forms.DataGridViewCellStyle>类包含以下与视觉样式相关的属性：</span><span class="sxs-lookup"><span data-stu-id="0c289-109">The <xref:System.Windows.Forms.DataGridViewCellStyle> class contains the following properties related to visual style:</span></span>  
  
- <span data-ttu-id="0c289-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="0c289-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span></span>  
  
- <span data-ttu-id="0c289-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="0c289-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span></span>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.Font%2A>  
  
 <span data-ttu-id="0c289-112">此类还包含以下与格式设置相关的属性：</span><span class="sxs-lookup"><span data-stu-id="0c289-112">This class also contains the following properties related to formatting:</span></span>  
  
- <span data-ttu-id="0c289-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span><span class="sxs-lookup"><span data-stu-id="0c289-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span></span>  
  
- <span data-ttu-id="0c289-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span><span class="sxs-lookup"><span data-stu-id="0c289-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span></span>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.Alignment%2A>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.Padding%2A>  
  
 <span data-ttu-id="0c289-115">有关这些属性以及其他单元格样式属性的详细信息，请参阅 <xref:System.Windows.Forms.DataGridViewCellStyle> 下面的 "另请参阅" 部分中列出的参考文档和主题。</span><span class="sxs-lookup"><span data-stu-id="0c289-115">For more information on these properties and other cell-style properties, see the <xref:System.Windows.Forms.DataGridViewCellStyle> reference documentation and the topics listed in the See Also section below.</span></span>  
  
## <a name="using-datagridviewcellstyle-objects"></a><span data-ttu-id="0c289-116">使用 DataGridViewCellStyle 对象</span><span class="sxs-lookup"><span data-stu-id="0c289-116">Using DataGridViewCellStyle Objects</span></span>  
 <span data-ttu-id="0c289-117">可以 <xref:System.Windows.Forms.DataGridViewCellStyle> 从 <xref:System.Windows.Forms.DataGridView> 、 <xref:System.Windows.Forms.DataGridViewColumn> 、 <xref:System.Windows.Forms.DataGridViewRow> 和 <xref:System.Windows.Forms.DataGridViewCell> 类及其派生类的各种属性中检索对象。</span><span class="sxs-lookup"><span data-stu-id="0c289-117">You can retrieve <xref:System.Windows.Forms.DataGridViewCellStyle> objects from various properties of the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and <xref:System.Windows.Forms.DataGridViewCell> classes and their derived classes.</span></span> <span data-ttu-id="0c289-118">如果尚未设置这些属性中的一个，则检索其值会创建一个新的 <xref:System.Windows.Forms.DataGridViewCellStyle> 对象。</span><span class="sxs-lookup"><span data-stu-id="0c289-118">If one of these properties has not yet been set, retrieving its value will create a new <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="0c289-119">你还可以实例化你自己的 <xref:System.Windows.Forms.DataGridViewCellStyle> 对象并将其分配给这些属性。</span><span class="sxs-lookup"><span data-stu-id="0c289-119">You can also instantiate your own <xref:System.Windows.Forms.DataGridViewCellStyle> objects and assign them to these properties.</span></span>  
  
 <span data-ttu-id="0c289-120">通过在 <xref:System.Windows.Forms.DataGridViewCellStyle> 多个元素之间共享对象，可以避免不必要地重复样式信息 <xref:System.Windows.Forms.DataGridView> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-120">You can avoid unnecessary duplication of style information by sharing <xref:System.Windows.Forms.DataGridViewCellStyle> objects among multiple <xref:System.Windows.Forms.DataGridView> elements.</span></span> <span data-ttu-id="0c289-121">由于在控件、列和行级别设置的样式会向下筛选每个级别到单元格级别，因此还可以通过仅设置每个级别上不同于上述级别的样式属性来避免样式重复。</span><span class="sxs-lookup"><span data-stu-id="0c289-121">Because the styles set at the control, column, and row levels filter down through each level to the cell level, you can also avoid style duplication by setting only those style properties at each level that differ from the levels above.</span></span> <span data-ttu-id="0c289-122">下面的 "样式继承" 部分对此进行了详细介绍。</span><span class="sxs-lookup"><span data-stu-id="0c289-122">This is described in more detail in the Style Inheritance section that follows.</span></span>  
  
 <span data-ttu-id="0c289-123">下表列出了获取或设置对象的主要属性 <xref:System.Windows.Forms.DataGridViewCellStyle> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-123">The following table lists the primary properties that get or set <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span>  
  
|<span data-ttu-id="0c289-124">属性</span><span class="sxs-lookup"><span data-stu-id="0c289-124">Property</span></span>|<span data-ttu-id="0c289-125">类</span><span class="sxs-lookup"><span data-stu-id="0c289-125">Classes</span></span>|<span data-ttu-id="0c289-126">描述</span><span class="sxs-lookup"><span data-stu-id="0c289-126">Description</span></span>|  
|--------------|-------------|-----------------|  
|`DefaultCellStyle`|<span data-ttu-id="0c289-127"><xref:System.Windows.Forms.DataGridView>、 <xref:System.Windows.Forms.DataGridViewColumn> 、 <xref:System.Windows.Forms.DataGridViewRow> 和派生类</span><span class="sxs-lookup"><span data-stu-id="0c289-127"><xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and derived classes</span></span>|<span data-ttu-id="0c289-128">获取或设置整个控件中所有单元格使用的默认样式 (包括标题单元) 、列或行。</span><span class="sxs-lookup"><span data-stu-id="0c289-128">Gets or sets default styles used by all cells in the entire control (including header cells), in a column, or in a row.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0c289-129">获取或设置控件中的所有行使用的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-129">Gets or sets default cell styles used by all rows in the control.</span></span> <span data-ttu-id="0c289-130">这不包括标头单元格。</span><span class="sxs-lookup"><span data-stu-id="0c289-130">This does not include header cells.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0c289-131">获取或设置控件中的交替行使用的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-131">Gets or sets default cell styles used by alternating rows in the control.</span></span> <span data-ttu-id="0c289-132">用于创建类似帐目型的效果。</span><span class="sxs-lookup"><span data-stu-id="0c289-132">Used to create a ledger-like effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0c289-133">获取或设置控件的行标题使用的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-133">Gets or sets default cell styles used by the control's row headers.</span></span> <span data-ttu-id="0c289-134">如果启用了视觉样式，则由当前主题重写。</span><span class="sxs-lookup"><span data-stu-id="0c289-134">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="0c289-135">获取或设置控件的列标题使用的默认单元格样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-135">Gets or sets default cell styles used by the control's column headers.</span></span> <span data-ttu-id="0c289-136">如果启用了视觉样式，则由当前主题重写。</span><span class="sxs-lookup"><span data-stu-id="0c289-136">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A>|<span data-ttu-id="0c289-137"><xref:System.Windows.Forms.DataGridViewCell> 和派生类</span><span class="sxs-lookup"><span data-stu-id="0c289-137"><xref:System.Windows.Forms.DataGridViewCell> and derived classes</span></span>|<span data-ttu-id="0c289-138">获取或设置在单元格级别指定的样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-138">Gets or sets styles specified at the cell level.</span></span> <span data-ttu-id="0c289-139">这些样式会重写从更高级别继承的样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-139">These styles override those inherited from higher levels.</span></span>|  
|`InheritedStyle`|<span data-ttu-id="0c289-140"><xref:System.Windows.Forms.DataGridViewCell>、 <xref:System.Windows.Forms.DataGridViewRow> 、 <xref:System.Windows.Forms.DataGridViewColumn> 和派生类</span><span class="sxs-lookup"><span data-stu-id="0c289-140"><xref:System.Windows.Forms.DataGridViewCell>, <xref:System.Windows.Forms.DataGridViewRow>, <xref:System.Windows.Forms.DataGridViewColumn>, and derived classes</span></span>|<span data-ttu-id="0c289-141">获取当前应用于单元格、行或列的所有样式，包括从更高级别的继承的样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-141">Gets all the styles currently applied to the cell, row, or column, including styles inherited from higher levels.</span></span>|  
  
 <span data-ttu-id="0c289-142">如上所述， <xref:System.Windows.Forms.DataGridViewCellStyle> 如果以前尚未设置属性，则获取样式属性的值会自动实例化新的对象。</span><span class="sxs-lookup"><span data-stu-id="0c289-142">As mentioned above, getting the value of a style property automatically instantiates a new <xref:System.Windows.Forms.DataGridViewCellStyle> object if the property has not been previously set.</span></span> <span data-ttu-id="0c289-143">若要避免不必要地创建这些对象，则行和列类具有一个 <xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A> 属性，你可以对其进行检查以确定是否已 <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A> 设置该属性。</span><span class="sxs-lookup"><span data-stu-id="0c289-143">To avoid creating these objects unnecessarily, the row and column classes have a <xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A> property that you can check to determine whether the <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A> property has been set.</span></span> <span data-ttu-id="0c289-144">同样，cell 类具有一个 <xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A> 属性，该属性指示是否已 <xref:System.Windows.Forms.DataGridViewCell.Style%2A> 设置属性。</span><span class="sxs-lookup"><span data-stu-id="0c289-144">Similarly, the cell classes have a <xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A> property that indicates whether the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property has been set.</span></span>  
  
 <span data-ttu-id="0c289-145">每个样式属性在控件上都有一个对应的 *PropertyName* `Changed` 事件 <xref:System.Windows.Forms.DataGridView> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-145">Each of the style properties has a corresponding *PropertyName*`Changed` event on the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="0c289-146">对于行、列和单元属性，事件的名称以 " `Row` "、" `Column` " 或 " `Cell` " 开头 (例如 <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>) 。</span><span class="sxs-lookup"><span data-stu-id="0c289-146">For row, column, and cell properties, the name of the event begins with "`Row`", "`Column`", or "`Cell`" (for example, <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>).</span></span> <span data-ttu-id="0c289-147">当相应的样式属性设置为另一对象时，将发生这些事件中的每一个 <xref:System.Windows.Forms.DataGridViewCellStyle> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-147">Each of these events occurs when the corresponding style property is set to a different <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="0c289-148"><xref:System.Windows.Forms.DataGridViewCellStyle>从样式属性检索对象并修改其属性值时，不会发生这些事件。</span><span class="sxs-lookup"><span data-stu-id="0c289-148">These events do not occur when you retrieve a <xref:System.Windows.Forms.DataGridViewCellStyle> object from a style property and modify its property values.</span></span> <span data-ttu-id="0c289-149">若要对单元格样式对象本身的更改做出响应，请处理 <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="0c289-149">To respond to changes to the cell style objects themselves, handle the <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged> event.</span></span>  
  
## <a name="style-inheritance"></a><span data-ttu-id="0c289-150">样式继承</span><span class="sxs-lookup"><span data-stu-id="0c289-150">Style Inheritance</span></span>  
 <span data-ttu-id="0c289-151">每个 <xref:System.Windows.Forms.DataGridViewCell> 从其属性中获取其外观 <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-151">Each <xref:System.Windows.Forms.DataGridViewCell> gets its appearance from its <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span> <span data-ttu-id="0c289-152"><xref:System.Windows.Forms.DataGridViewCellStyle>此属性返回的对象从类型为的属性的层次结构继承其值 <xref:System.Windows.Forms.DataGridViewCellStyle> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-152">The <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by this property inherits its values from a hierarchy of properties of type <xref:System.Windows.Forms.DataGridViewCellStyle>.</span></span> <span data-ttu-id="0c289-153">下面列出了这些属性，这些属性的顺序如下： <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> 非标头单元格获取其值的顺序。</span><span class="sxs-lookup"><span data-stu-id="0c289-153">These properties are listed below in the order in which the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> for non-header cells obtains its values.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
3. <span data-ttu-id="0c289-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> 仅对具有奇数索引号的行中的单元格 () </span><span class="sxs-lookup"><span data-stu-id="0c289-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
4. <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
5. <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
6. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0c289-155">对于行标题单元格和列标题单元格， <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> 按给定顺序按下面的源属性列表中的值填充属性。</span><span class="sxs-lookup"><span data-stu-id="0c289-155">For row and column header cells, the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property is populated by values from the following list of source properties in the given order.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2. <span data-ttu-id="0c289-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> 或 <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="0c289-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span></span>  
  
3. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0c289-157">下图演示了此过程。</span><span class="sxs-lookup"><span data-stu-id="0c289-157">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="0c289-158">![类型 DataGridViewCellStyle 的属性](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells 继承关系图")</span><span class="sxs-lookup"><span data-stu-id="0c289-158">![Properties of type DataGridViewCellStyle](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells inheritance diagram")</span></span>  
  
 <span data-ttu-id="0c289-159">还可以访问特定行和列继承的样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-159">You can also access the styles inherited by specific rows and columns.</span></span> <span data-ttu-id="0c289-160">列 <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A> 属性从以下属性继承其值。</span><span class="sxs-lookup"><span data-stu-id="0c289-160">The column <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0c289-161">Row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> 属性从以下属性继承其值。</span><span class="sxs-lookup"><span data-stu-id="0c289-161">The row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2. <span data-ttu-id="0c289-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> 仅对具有奇数索引号的行中的单元格 () </span><span class="sxs-lookup"><span data-stu-id="0c289-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
3. <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
4. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="0c289-163">对于属性返回的对象中的每个属性 <xref:System.Windows.Forms.DataGridViewCellStyle> `InheritedStyle` ，将从相应列表中的第一个单元格样式获取属性值，该列表中的相应属性设置为默认值以外的值 <xref:System.Windows.Forms.DataGridViewCellStyle> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-163">For each property in a <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by an `InheritedStyle` property, the property value is obtained from the first cell style in the appropriate list that has the corresponding property set to a value other than the <xref:System.Windows.Forms.DataGridViewCellStyle> class defaults.</span></span>  
  
 <span data-ttu-id="0c289-164">下表说明了如何 <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> 从其包含列继承示例单元格的属性值。</span><span class="sxs-lookup"><span data-stu-id="0c289-164">The following table illustrates how the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value for an example cell is inherited from its containing column.</span></span>  
  
|<span data-ttu-id="0c289-165">类型的属性 `DataGridViewCellStyle`</span><span class="sxs-lookup"><span data-stu-id="0c289-165">Property of type `DataGridViewCellStyle`</span></span>|<span data-ttu-id="0c289-166">`ForeColor`检索的对象的示例值</span><span class="sxs-lookup"><span data-stu-id="0c289-166">Example `ForeColor` value for retrieved object</span></span>|  
|----------------------------------------------|----------------------------------------------------|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.DarkBlue%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Black%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="0c289-167">在这种情况下，该 <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType> 单元格的行中的值是列表中的第一个实际值。</span><span class="sxs-lookup"><span data-stu-id="0c289-167">In this case, the <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType> value from the cell's row is the first real value on the list.</span></span> <span data-ttu-id="0c289-168">这将成为该 <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> 单元格的属性值 <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-168">This becomes the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value of the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>.</span></span>  
  
 <span data-ttu-id="0c289-169">下图说明了不同 <xref:System.Windows.Forms.DataGridViewCellStyle> 属性如何从不同的位置继承其值。</span><span class="sxs-lookup"><span data-stu-id="0c289-169">The following diagram illustrates how different <xref:System.Windows.Forms.DataGridViewCellStyle> properties can inherit their values from different places.</span></span>  
  
 <span data-ttu-id="0c289-170">![DataGridView 属性&#45;值继承](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells 值继承关系图")</span><span class="sxs-lookup"><span data-stu-id="0c289-170">![DataGridView property&#45;value inheritance](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells value inheritance diagram")</span></span>  
  
 <span data-ttu-id="0c289-171">利用样式继承，可以为整个控件提供适当的样式，而不必在多个位置指定相同的信息。</span><span class="sxs-lookup"><span data-stu-id="0c289-171">By taking advantage of style inheritance, you can provide appropriate styles for the entire control without having to specify the same information in multiple places.</span></span>  
  
 <span data-ttu-id="0c289-172">尽管标头单元格参与到样式继承（如所述），但控件的和属性返回的对象 <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> <xref:System.Windows.Forms.DataGridView> 具有初始属性值，这些值将重写属性返回的对象的属性值 <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-172">Although header cells participate in style inheritance as described, the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties of the <xref:System.Windows.Forms.DataGridView> control have initial property values that override the property values of the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="0c289-173">如果要将属性返回的对象的属性设置 <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> 为应用于行标题和列标题，则必须将和属性返回的对象的相应属性设置为为 <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> 类指定的默认值 <xref:System.Windows.Forms.DataGridViewCellStyle> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-173">If you want the properties set for the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property to apply to row and column headers, you must set the corresponding properties of the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties to the defaults indicated for the <xref:System.Windows.Forms.DataGridViewCellStyle> class.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c289-174">如果启用了视觉样式，则除) 之外的行标题和列标题 (<xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A> 会自动按当前主题样式进行样式，并覆盖这些属性指定的任何样式。</span><span class="sxs-lookup"><span data-stu-id="0c289-174">If visual styles are enabled, the row and column headers (except for the <xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) are automatically styled by the current theme, overriding any styles specified by these properties.</span></span>  
  
 <span data-ttu-id="0c289-175"><xref:System.Windows.Forms.DataGridViewButtonColumn>、 <xref:System.Windows.Forms.DataGridViewImageColumn> 和 <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> 类型还初始化由列属性返回的对象的某些值 <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-175">The <xref:System.Windows.Forms.DataGridViewButtonColumn>, <xref:System.Windows.Forms.DataGridViewImageColumn>, and <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> types also initialize some values of the object returned by the column <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="0c289-176">有关详细信息，请参阅这些类型的参考文档。</span><span class="sxs-lookup"><span data-stu-id="0c289-176">For more information, see the reference documentation for these types.</span></span>  
  
## <a name="setting-styles-dynamically"></a><span data-ttu-id="0c289-177">动态设置样式</span><span class="sxs-lookup"><span data-stu-id="0c289-177">Setting Styles Dynamically</span></span>  
 <span data-ttu-id="0c289-178">若要自定义具有特定值的单元格样式，请实现事件的处理程序 <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-178">To customize the styles of cells with particular values, implement a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="0c289-179">此事件的处理程序接收类型的参数 <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-179">Handlers for this event receive an argument of the <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs> type.</span></span> <span data-ttu-id="0c289-180">此对象包含一些属性，这些属性使你可以确定要设置格式的单元格的值及其在控件中的位置 <xref:System.Windows.Forms.DataGridView> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-180">This object contains properties that let you determine the value of the cell being formatted along with its location in the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="0c289-181">此对象还包含一个 <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A> 属性，该属性被初始化为 <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> 正在格式化的单元格的属性值。</span><span class="sxs-lookup"><span data-stu-id="0c289-181">This object also contains a <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A> property that is initialized to the value of the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property of the cell being formatted.</span></span> <span data-ttu-id="0c289-182">您可以修改单元样式属性以指定适合单元值和位置的样式信息。</span><span class="sxs-lookup"><span data-stu-id="0c289-182">You can modify the cell style properties to specify style information appropriate to the cell value and location.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c289-183"><xref:System.Windows.Forms.DataGridView.RowPrePaint>和 <xref:System.Windows.Forms.DataGridView.RowPostPaint> 事件也会接收到 <xref:System.Windows.Forms.DataGridViewCellStyle> 事件数据中的对象，但在这种情况下，它是行属性的副本 <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> 以进行只读的，并且不会影响控件。</span><span class="sxs-lookup"><span data-stu-id="0c289-183">The <xref:System.Windows.Forms.DataGridView.RowPrePaint> and <xref:System.Windows.Forms.DataGridView.RowPostPaint> events also receive a <xref:System.Windows.Forms.DataGridViewCellStyle> object in the event data, but in their case, it is a copy of the row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property for read-only purposes, and changes to it do not affect the control.</span></span>  
  
 <span data-ttu-id="0c289-184">您还可以动态修改各个单元格的样式，以响应和事件之类的 <xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType> 事件 <xref:System.Windows.Forms.DataGridView.CellMouseLeave> 。</span><span class="sxs-lookup"><span data-stu-id="0c289-184">You can also dynamically modify the styles of individual cells in response to events such as the <xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridView.CellMouseLeave> events.</span></span> <span data-ttu-id="0c289-185">例如，在事件处理程序中 <xref:System.Windows.Forms.DataGridView.CellMouseEnter> ，您可以将单元格背景色 (的当前值存储 <xref:System.Windows.Forms.DataGridViewCell.Style%2A>) ，并将其设置为新的颜色，当鼠标悬停在该单元格上时，将突出显示该单元格。</span><span class="sxs-lookup"><span data-stu-id="0c289-185">For example, in a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseEnter> event, you could store the current value of the cell background color (retrieved through the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property), then set it to a new color that will highlight the cell when the mouse hovers over it.</span></span> <span data-ttu-id="0c289-186">在事件的处理程序中 <xref:System.Windows.Forms.DataGridView.CellMouseLeave> ，您可以将背景色还原为原始值。</span><span class="sxs-lookup"><span data-stu-id="0c289-186">In a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseLeave> event, you can then restore the background color to the original value.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c289-187">不管是否设置了某个特定样式值，缓存存储在单元格中的值 <xref:System.Windows.Forms.DataGridViewCell.Style%2A> 都非常重要。</span><span class="sxs-lookup"><span data-stu-id="0c289-187">Caching the values stored in the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property is important regardless of whether a particular style value is set.</span></span> <span data-ttu-id="0c289-188">如果你暂时替换某个样式设置，则将其还原到其原始 "未设置" 状态可确保单元格返回到从较高级别继承样式设置。</span><span class="sxs-lookup"><span data-stu-id="0c289-188">If you temporarily replace a style setting, restoring it to its original "not set" state ensures that the cell will go back to inheriting the style setting from a higher level.</span></span> <span data-ttu-id="0c289-189">如果需要确定单元的实际有效样式，而不管样式是否继承，请使用单元格的 <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> 属性。</span><span class="sxs-lookup"><span data-stu-id="0c289-189">If you need to determine the actual style in effect for a cell regardless of whether the style is inherited, use the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0c289-190">另请参阅</span><span class="sxs-lookup"><span data-stu-id="0c289-190">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridViewCellStyle>
- <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPrePaint?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPostPaint?displayProperty=nameWithType>
- [<span data-ttu-id="0c289-191">Windows 窗体 DataGridView 控件中的基本格式设置和样式设置</span><span class="sxs-lookup"><span data-stu-id="0c289-191">Basic Formatting and Styling in the Windows Forms DataGridView Control</span></span>](basic-formatting-and-styling-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0c289-192">如何：设置 Windows 窗体 DataGridView 控件的默认单元格样式</span><span class="sxs-lookup"><span data-stu-id="0c289-192">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0c289-193">Windows 窗体 DataGridView 控件中的数据格式设置</span><span class="sxs-lookup"><span data-stu-id="0c289-193">Data Formatting in the Windows Forms DataGridView Control</span></span>](data-formatting-in-the-windows-forms-datagridview-control.md)
