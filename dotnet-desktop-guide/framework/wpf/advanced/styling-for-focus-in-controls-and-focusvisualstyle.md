---
title: 为控件中的焦点设置样式以及 FocusVisualStyle
ms.date: 03/30/2017
helpviewer_keywords:
- keyboard focus [WPF]
- focus [WPF], visual styling
- styles [WPF], focus visual style
ms.assetid: 786ac576-011b-4d72-913b-558deccb9b35
ms.openlocfilehash: 3d038f0e1687efb0c2516602e8d5cbf24a60b36c
ms.sourcegitcommit: bf5dd80f4d7b202afa90e90d1148402c5474d826
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/30/2021
ms.locfileid: "96973388"
---
# <a name="styling-for-focus-in-controls-and-focusvisualstyle"></a><span data-ttu-id="85063-102">为控件中的焦点设置样式以及 FocusVisualStyle</span><span class="sxs-lookup"><span data-stu-id="85063-102">Styling for Focus in Controls, and FocusVisualStyle</span></span>
[!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="85063-103">提供两种用于在控件接收键盘焦点时更改其视觉外观的并行机制。</span><span class="sxs-lookup"><span data-stu-id="85063-103">provides two parallel mechanisms for changing the visual appearance of a control when it receives keyboard focus.</span></span> <span data-ttu-id="85063-104">第一种机制是对 <xref:System.Windows.UIElement.IsKeyboardFocused%2A> 应用于控件的样式或模板中的属性使用属性 setter。</span><span class="sxs-lookup"><span data-stu-id="85063-104">The first mechanism is to use property setters for properties such as <xref:System.Windows.UIElement.IsKeyboardFocused%2A> within the style or template that is applied to the control.</span></span> <span data-ttu-id="85063-105">第二种机制是提供单独的样式作为属性的值 <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> ; "焦点视觉样式" 为在控件顶部绘制的装饰器创建单独的可视化树，而不是通过替换控件或其他 UI 元素来更改它的可视化树。</span><span class="sxs-lookup"><span data-stu-id="85063-105">The second mechanism is to provide a separate style as the value of the <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> property; the "focus visual style" creates a separate visual tree for an adorner that draws on top of the control, rather than changing the visual tree of the control or other UI element by replacing it.</span></span> <span data-ttu-id="85063-106">本主题讨论上述每一种机制的适用情况。</span><span class="sxs-lookup"><span data-stu-id="85063-106">This topic discusses the scenarios where each of these mechanisms is appropriate.</span></span>  

<a name="Purpose"></a>
## <a name="the-purpose-of-focus-visual-style"></a><span data-ttu-id="85063-107">焦点视觉样式的用途</span><span class="sxs-lookup"><span data-stu-id="85063-107">The Purpose of Focus Visual Style</span></span>  
 <span data-ttu-id="85063-108">焦点视觉样式功能提供一种通用“对象模型”，用于基于任何 UI 元素的键盘导航来引入视觉用户反馈。</span><span class="sxs-lookup"><span data-stu-id="85063-108">The focus visual style feature provides a common "object model" for introducing visual user feedback based on keyboard navigation to any UI element.</span></span> <span data-ttu-id="85063-109">即使未向控件应用新模板，或者不知道具体的模板组合，这也是可能的。</span><span class="sxs-lookup"><span data-stu-id="85063-109">This is possible without applying a new template to the control, or knowing the specific template composition.</span></span>  
  
 <span data-ttu-id="85063-110">但是，正因为焦点视觉样式功能可以在不知道控件模板的情况下工作，所以必须限制可针对使用焦点视觉样式的控件显示的视觉反馈。</span><span class="sxs-lookup"><span data-stu-id="85063-110">However, precisely because the focus visual style feature works without knowing the control templates, the visual feedback that can be displayed for a control using a focus visual style is necessarily limited.</span></span> <span data-ttu-id="85063-111">此功能实际执行的操作是在控件通过模板进行呈现来创建可视化树时在其上覆盖另一可视化树（装饰器）。</span><span class="sxs-lookup"><span data-stu-id="85063-111">What the feature actually does is to overlay a different visual tree (an adorner) on top of the visual tree as created by a control's rendering through its template.</span></span> <span data-ttu-id="85063-112">使用填充属性的样式定义此单独的可视化树 <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> 。</span><span class="sxs-lookup"><span data-stu-id="85063-112">You define this separate visual tree using a style that fills the <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> property.</span></span>  
  
<a name="Default"></a>
## <a name="default-focus-visual-style-behavior"></a><span data-ttu-id="85063-113">默认焦点视觉样式行为</span><span class="sxs-lookup"><span data-stu-id="85063-113">Default Focus Visual Style Behavior</span></span>  
 <span data-ttu-id="85063-114">焦点视觉样式仅在焦点操作由键盘启动时才起作用。</span><span class="sxs-lookup"><span data-stu-id="85063-114">Focus visual styles act only when the focus action was initiated by the keyboard.</span></span> <span data-ttu-id="85063-115">任何鼠标操作或者通过编程实现的焦点更改都会禁用焦点视觉样式模式。</span><span class="sxs-lookup"><span data-stu-id="85063-115">Any mouse action or programmatic focus change disables the mode for focus visual styles.</span></span> <span data-ttu-id="85063-116">有关焦点模式间区别的详细信息，请参阅[焦点概述](focus-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="85063-116">For more information about the distinctions between focus modes, see [Focus Overview](focus-overview.md).</span></span>  
  
 <span data-ttu-id="85063-117">控件的主题包括默认焦点视觉样式行为，该焦点视觉样式成为主题中所有控件的焦点视觉样式。</span><span class="sxs-lookup"><span data-stu-id="85063-117">The themes for controls include a default focus visual style behavior that becomes the focus visual style for all controls in the theme.</span></span> <span data-ttu-id="85063-118">此主题样式由静态键的值标识 <xref:System.Windows.SystemParameters.FocusVisualStyleKey%2A> 。</span><span class="sxs-lookup"><span data-stu-id="85063-118">This theme style is identified by the value of the static key <xref:System.Windows.SystemParameters.FocusVisualStyleKey%2A>.</span></span> <span data-ttu-id="85063-119">当在应用程序级声明自己的焦点视觉样式时，将替换主题中的这一默认样式行为。</span><span class="sxs-lookup"><span data-stu-id="85063-119">When you declare your own focus visual style at the application level, you replace this default style behavior from the themes.</span></span> <span data-ttu-id="85063-120">或者，如果要定义整个主题，那么应同样使用这个键来为整个主题的默认行为定义样式。</span><span class="sxs-lookup"><span data-stu-id="85063-120">Alternatively, if you define the entire theme, then you should use this same key to define the style for the default behavior for your entire theme.</span></span>  
  
 <span data-ttu-id="85063-121">在主题中，默认焦点视觉样式通常非常简单。</span><span class="sxs-lookup"><span data-stu-id="85063-121">In the themes, the default focus visual style is generally very simple.</span></span> <span data-ttu-id="85063-122">下面是一个近似的焦点视觉样式：</span><span class="sxs-lookup"><span data-stu-id="85063-122">The following is a rough approximation:</span></span>  
  
```xaml  
<Style x:Key="{x:Static SystemParameters.FocusVisualStyleKey}">  
  <Setter Property="Control.Template">  
    <Setter.Value>  
      <ControlTemplate>  
        <Rectangle StrokeThickness="1"  
          Stroke="Black"  
          StrokeDashArray="1 2"  
          SnapsToDevicePixels="true"/>  
      </ControlTemplate>  
    </Setter.Value>  
  </Setter>  
</Style>  
```  
  
<a name="When"></a>
## <a name="when-to-use-focus-visual-styles"></a><span data-ttu-id="85063-123">何时使用焦点视觉样式</span><span class="sxs-lookup"><span data-stu-id="85063-123">When to Use Focus Visual Styles</span></span>  
 <span data-ttu-id="85063-124">从概念上来说，应用于控件的焦点视觉样式的外观在所有控件上应该是一致的。</span><span class="sxs-lookup"><span data-stu-id="85063-124">Conceptually, the appearance of focus visual styles applied to controls should be coherent from control to control.</span></span> <span data-ttu-id="85063-125">确保一致性的一种方法是仅在创作整个主题时才更改焦点视觉样式，这样主题中定义的每个控件都要么获得完全相同的焦点视觉样式，要么获得在视觉上与控件具有相关性的某一样式的变体。</span><span class="sxs-lookup"><span data-stu-id="85063-125">One way to ensure coherence is to change the focus visual style only if you are composing an entire theme, where each control that is defined in the theme gets either the very same focus visual style, or some variation of a style that is visually related from control to control.</span></span> <span data-ttu-id="85063-126">或者，可能使用相同的样式（或类似的样式）来设置页面或 UI 中每个可通过键盘获得焦点的元素的样式。</span><span class="sxs-lookup"><span data-stu-id="85063-126">Alternatively, you might use the same style (or similar styles) to style every keyboard-focusable element on a page or in a UI.</span></span>  
  
 <span data-ttu-id="85063-127">不 <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> 属于主题的单独控件样式的设置并不是焦点视觉样式的预期用法。</span><span class="sxs-lookup"><span data-stu-id="85063-127">Setting <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> on individual control styles that are not part of a theme is not the intended usage of focus visual styles.</span></span> <span data-ttu-id="85063-128">这是因为控件间的不一致视觉行为会使用户对键盘焦点产生混乱的感觉。</span><span class="sxs-lookup"><span data-stu-id="85063-128">This is because an inconsistent visual behavior between controls can lead to a confusing user experience regarding keyboard focus.</span></span> <span data-ttu-id="85063-129">如果要为键盘焦点设计特定于控件的行为，而这些行为在主题中特意不连贯，更好的方法是使用各个输入状态属性（如或）的样式中的触发器 <xref:System.Windows.UIElement.IsFocused%2A> <xref:System.Windows.UIElement.IsKeyboardFocused%2A> 。</span><span class="sxs-lookup"><span data-stu-id="85063-129">If you are intending control-specific behaviors for keyboard focus that are deliberately not coherent across a theme, a much better approach is to use triggers in styles for individual input state properties, such as <xref:System.Windows.UIElement.IsFocused%2A> or <xref:System.Windows.UIElement.IsKeyboardFocused%2A>.</span></span>  
  
 <span data-ttu-id="85063-130">焦点视觉样式专门作用于键盘焦点。</span><span class="sxs-lookup"><span data-stu-id="85063-130">Focus visual styles act exclusively for keyboard focus.</span></span> <span data-ttu-id="85063-131">就其本身而言，焦点视觉样式是一种辅助功能。</span><span class="sxs-lookup"><span data-stu-id="85063-131">As such, focus visual styles are a type of accessibility feature.</span></span> <span data-ttu-id="85063-132">如果希望针对任何类型的焦点来更改 UI（无论是通过鼠标、键盘还是编程方式），那么不应使用焦点视觉样式，而应在样式或模板中使用 setter 和触发器，它们根据常规焦点属性（如 <xref:System.Windows.UIElement.IsFocused%2A> 或 <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>）的值发生作用。</span><span class="sxs-lookup"><span data-stu-id="85063-132">If you want UI changes for any type of focus, whether via mouse, keyboard, or programmatically, then you should not use focus visual styles, and should instead use setters and triggers in styles or templates that are working from the value of general focus properties such as <xref:System.Windows.UIElement.IsFocused%2A> or <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>.</span></span>  
  
<a name="How"></a>
## <a name="how-to-create-a-focus-visual-style"></a><span data-ttu-id="85063-133">如何创建焦点视觉样式</span><span class="sxs-lookup"><span data-stu-id="85063-133">How to Create a Focus Visual Style</span></span>  
 <span data-ttu-id="85063-134">为焦点视觉样式创建的样式应始终具有 <xref:System.Windows.Style.TargetType%2A> 的 <xref:System.Windows.Controls.Control> 。</span><span class="sxs-lookup"><span data-stu-id="85063-134">The style you create for a focus visual style should always have the <xref:System.Windows.Style.TargetType%2A> of <xref:System.Windows.Controls.Control>.</span></span> <span data-ttu-id="85063-135">样式应主要包括 <xref:System.Windows.Controls.ControlTemplate> 。</span><span class="sxs-lookup"><span data-stu-id="85063-135">The style should consist mainly of a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="85063-136">不要将目标类型指定为将焦点视觉样式分配给的类型 <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A> 。</span><span class="sxs-lookup"><span data-stu-id="85063-136">You do not specify the target type to be the type where the focus visual style is assigned to the <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>.</span></span>  
  
 <span data-ttu-id="85063-137">由于目标类型始终为 <xref:System.Windows.Controls.Control> ，因此你必须使用所有控件共有的属性来进行样式， (使用类的属性 <xref:System.Windows.Controls.Control> 及其基类) 。</span><span class="sxs-lookup"><span data-stu-id="85063-137">Because the target type is always <xref:System.Windows.Controls.Control>, you must style by using properties that are common to all controls (using properties of the <xref:System.Windows.Controls.Control> class and its base classes).</span></span> <span data-ttu-id="85063-138">应创建将正确地用作 UI 元素的覆盖层、且不会隐藏控件的功能区域的模板。</span><span class="sxs-lookup"><span data-stu-id="85063-138">You should create a template that will properly function as an overlay to a UI element and that will not obscure functional areas of the control.</span></span> <span data-ttu-id="85063-139">通常，这意味着视觉反馈应显示在控件边距之外，或者显示为临时的或不显眼的效果（这样就不会阻止应用焦点视觉样式的控件上的命中测试）。</span><span class="sxs-lookup"><span data-stu-id="85063-139">Generally, this means that the visual feedback should appear outside the control margins, or as temporary or unobtrusive effects that will not block the hit testing on the control where the focus visual style is applied.</span></span> <span data-ttu-id="85063-140">可在模板绑定中使用的属性，这些属性可用于确定覆盖模板的大小和位置 <xref:System.Windows.FrameworkElement.ActualHeight%2A> （包括、 <xref:System.Windows.FrameworkElement.ActualWidth%2A> 、和） <xref:System.Windows.FrameworkElement.Margin%2A> <xref:System.Windows.Controls.Control.Padding%2A> 。</span><span class="sxs-lookup"><span data-stu-id="85063-140">Properties that you can use in template binding that are useful for determining sizing and positioning of your overlay template include <xref:System.Windows.FrameworkElement.ActualHeight%2A>, <xref:System.Windows.FrameworkElement.ActualWidth%2A>, <xref:System.Windows.FrameworkElement.Margin%2A>, and <xref:System.Windows.Controls.Control.Padding%2A>.</span></span>  
  
<a name="Alternatives"></a>
## <a name="alternatives-to-using-a-focus-visual-style"></a><span data-ttu-id="85063-141">使用焦点视觉样式的替代方法</span><span class="sxs-lookup"><span data-stu-id="85063-141">Alternatives to Using a Focus Visual Style</span></span>  
 <span data-ttu-id="85063-142">对于不适合使用焦点视觉样式的情况（因为仅设置单个控件的样式或希望对控件模板有更多的控制），存在许多其他可用的属性和技术，可用来创建响应焦点更改的视觉行为。</span><span class="sxs-lookup"><span data-stu-id="85063-142">For situations where using a focus visual style is not appropriate, either because you are only styling single controls or because you want greater control over the control template, there are many other accessible properties and techniques that can create visual behavior in response to changes in focus.</span></span>  
  
 <span data-ttu-id="85063-143">[样式设置和模板化](/dotnet/desktop-wpf/fundamentals/styles-templates-overview)中对触发器、setter 以及事件 setter 进行了详细介绍。</span><span class="sxs-lookup"><span data-stu-id="85063-143">Triggers, setters, and event setters are all discussed in detail in [Styling and Templating](/dotnet/desktop-wpf/fundamentals/styles-templates-overview).</span></span> <span data-ttu-id="85063-144">[路由事件概述](routed-events-overview.md)中对路由事件处理进行了介绍。</span><span class="sxs-lookup"><span data-stu-id="85063-144">Routed event handling is discussed in [Routed Events Overview](routed-events-overview.md).</span></span>  
  
### <a name="iskeyboardfocused"></a><span data-ttu-id="85063-145">IsKeyboardFocused</span><span class="sxs-lookup"><span data-stu-id="85063-145">IsKeyboardFocused</span></span>  
 <span data-ttu-id="85063-146">如果对键盘焦点特别感兴趣，则 <xref:System.Windows.UIElement.IsKeyboardFocused%2A> 可将依赖属性用于属性 <xref:System.Windows.Trigger> 。</span><span class="sxs-lookup"><span data-stu-id="85063-146">If you are specifically interested in keyboard focus, the <xref:System.Windows.UIElement.IsKeyboardFocused%2A> dependency property can be used for a property <xref:System.Windows.Trigger>.</span></span> <span data-ttu-id="85063-147">对于定义专用于单个控件且可能与其他控件的键盘焦点行为在视觉上不匹配的键盘焦点行为，一个更适合的方法是使用样式或模板中的属性触发器。</span><span class="sxs-lookup"><span data-stu-id="85063-147">A property trigger in either a style or template is a more appropriate technique for defining a keyboard focus behavior that is very specifically for a single control, and which might not visually match the keyboard focus behavior for other controls.</span></span>  
  
 <span data-ttu-id="85063-148">另一个类似的依赖项属性是 <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> ，如果想要直观地调出键盘焦点位于控件内或控件的功能区域内的某个位置，则可能适合使用这种属性。</span><span class="sxs-lookup"><span data-stu-id="85063-148">Another similar dependency property is <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>, which might be appropriate to use if you want to visually call out that keyboard focus is somewhere within compositing or within the functional area of the control.</span></span> <span data-ttu-id="85063-149">例如，你可能会放置 <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> 一个触发器，以便对多个控件进行分组的面板显示方式不同，即使键盘焦点可能更精确地位于该面板内的单个元素上。</span><span class="sxs-lookup"><span data-stu-id="85063-149">For example, you might place an <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> trigger such that a panel that groups several controls appears differently, even though keyboard focus might more precisely be on an individual element within that panel.</span></span>  
  
 <span data-ttu-id="85063-150">你还可以使用事件 <xref:System.Windows.UIElement.GotKeyboardFocus> 和 <xref:System.Windows.UIElement.LostKeyboardFocus> (及其预览等效) 。</span><span class="sxs-lookup"><span data-stu-id="85063-150">You can also use the events <xref:System.Windows.UIElement.GotKeyboardFocus> and <xref:System.Windows.UIElement.LostKeyboardFocus> (as well as their Preview equivalents).</span></span> <span data-ttu-id="85063-151">可以将这些事件用作的基础 <xref:System.Windows.EventSetter> ，也可以在代码隐藏中编写事件的处理程序。</span><span class="sxs-lookup"><span data-stu-id="85063-151">You can use these events as the basis for an <xref:System.Windows.EventSetter>, or you can write handlers for the events in code-behind.</span></span>  
  
### <a name="other-focus-properties"></a><span data-ttu-id="85063-152">其他焦点属性</span><span class="sxs-lookup"><span data-stu-id="85063-152">Other Focus Properties</span></span>  
 <span data-ttu-id="85063-153">如果希望更改焦点以生成可视行为的所有可能原因，则应基于 <xref:System.Windows.UIElement.IsFocused%2A> 依赖项属性或 <xref:System.Windows.UIElement.GotFocus> 或用于的或 <xref:System.Windows.UIElement.LostFocus> 事件来构建资源库或触发器 <xref:System.Windows.EventSetter> 。</span><span class="sxs-lookup"><span data-stu-id="85063-153">If you want all possible causes of changing focus to produce a visual behavior, you should base a setter or trigger on the <xref:System.Windows.UIElement.IsFocused%2A> dependency property, or alternatively on the <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus> events used for an <xref:System.Windows.EventSetter>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="85063-154">请参阅</span><span class="sxs-lookup"><span data-stu-id="85063-154">See also</span></span>

- <xref:System.Windows.FrameworkElement.FocusVisualStyle%2A>
- [<span data-ttu-id="85063-155">样式设置和模板化</span><span class="sxs-lookup"><span data-stu-id="85063-155">Styling and Templating</span></span>](/dotnet/desktop-wpf/fundamentals/styles-templates-overview)
- [<span data-ttu-id="85063-156">焦点概述</span><span class="sxs-lookup"><span data-stu-id="85063-156">Focus Overview</span></span>](focus-overview.md)
- [<span data-ttu-id="85063-157">输入概述</span><span class="sxs-lookup"><span data-stu-id="85063-157">Input Overview</span></span>](input-overview.md)
