---
title: 事件概述
description: 有关 .NET Windows 窗体中的事件的简要概述。
ms.date: 10/26/2020
ms.topic: overview
helpviewer_keywords:
- Windows Forms, event handling
- events [Windows Forms], about events
- delegates [Windows Forms], multicast
- delegates [Windows Forms], events and
- multicast event delegates
- Windows Forms controls, events
ms.openlocfilehash: aed33b7b856da210855a5b06ccf53610a6551b47
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/09/2020
ms.locfileid: "96941989"
---
# <a name="events-overview-windows-forms-net"></a><span data-ttu-id="c740c-103">事件概述（Windows 窗体 .NET）</span><span class="sxs-lookup"><span data-stu-id="c740c-103">Events overview (Windows Forms .NET)</span></span>

<span data-ttu-id="c740c-104">事件是可以通过代码响应或“处理”的操作。</span><span class="sxs-lookup"><span data-stu-id="c740c-104">An event is an action that you can respond to, or "handle," in code.</span></span> <span data-ttu-id="c740c-105">事件可由用户操作（例如单击鼠标或按某个键）、程序代码或系统生成。</span><span class="sxs-lookup"><span data-stu-id="c740c-105">Events can be generated by a user action, such as clicking the mouse or pressing a key, by program code, or by the system.</span></span>

[!INCLUDE [desktop guide under construction](../../includes/desktop-guide-preview-note.md)]

<span data-ttu-id="c740c-106">事件驱动的应用程序执行代码以响应事件。</span><span class="sxs-lookup"><span data-stu-id="c740c-106">Event-driven applications execute code in response to an event.</span></span> <span data-ttu-id="c740c-107">每个窗体和控件都公开一组预定义事件，你可根据这些事件进行编程。</span><span class="sxs-lookup"><span data-stu-id="c740c-107">Each form and control exposes a predefined set of events that you can program against.</span></span> <span data-ttu-id="c740c-108">如果发生其中一个事件并且在相关联的事件处理程序中有代码，则调用该代码。</span><span class="sxs-lookup"><span data-stu-id="c740c-108">If one of these events occurs and there's code an associated event handler, that code is invoked.</span></span>

<span data-ttu-id="c740c-109">对象引发的事件类型会发生变化，但对于大多数控件，很多类型都是通用的。</span><span class="sxs-lookup"><span data-stu-id="c740c-109">The types of events raised by an object vary, but many types are common to most controls.</span></span> <span data-ttu-id="c740c-110">例如，大多数对象都会处理 <xref:System.Windows.Forms.Control.Click> 事件。</span><span class="sxs-lookup"><span data-stu-id="c740c-110">For example, most objects will handle a <xref:System.Windows.Forms.Control.Click> event.</span></span> <span data-ttu-id="c740c-111">如果用户单击窗体，就会执行窗体的 <xref:System.Windows.Forms.Control.Click> 事件处理程序内的代码。</span><span class="sxs-lookup"><span data-stu-id="c740c-111">If a user clicks a form, code in the form's <xref:System.Windows.Forms.Control.Click> event handler is executed.</span></span>

> [!NOTE]
> <span data-ttu-id="c740c-112">许多事件会与其他事件同时发生。</span><span class="sxs-lookup"><span data-stu-id="c740c-112">Many events occur in conjunction with other events.</span></span> <span data-ttu-id="c740c-113">例如，在发生 <xref:System.Windows.Forms.Control.DoubleClick> 事件期间，还会发生 <xref:System.Windows.Forms.Control.MouseDown>、<xref:System.Windows.Forms.Control.MouseUp> 以及 <xref:System.Windows.Forms.Control.Click> 事件。</span><span class="sxs-lookup"><span data-stu-id="c740c-113">For example, in the course of the <xref:System.Windows.Forms.Control.DoubleClick> event occurring, the <xref:System.Windows.Forms.Control.MouseDown>, <xref:System.Windows.Forms.Control.MouseUp>, and <xref:System.Windows.Forms.Control.Click> events occur.</span></span>

<span data-ttu-id="c740c-114">有关如何引发和使用事件的信息，请参阅[处理和引发事件](/dotnet/standard/events/index)。</span><span class="sxs-lookup"><span data-stu-id="c740c-114">For information about how to raise and consume an event, see [Handling and raising events](/dotnet/standard/events/index).</span></span>

## <a name="delegates-and-their-role"></a><span data-ttu-id="c740c-115">委托及其角色</span><span class="sxs-lookup"><span data-stu-id="c740c-115">Delegates and their role</span></span>

<span data-ttu-id="c740c-116">委托是 .NET 中通常用于建立事件处理机制的类。</span><span class="sxs-lookup"><span data-stu-id="c740c-116">Delegates are classes commonly used within .NET to build event-handling mechanisms.</span></span> <span data-ttu-id="c740c-117">委托大体上相当于 Visual C++ 和其他面向对象语言中常用的函数指针。</span><span class="sxs-lookup"><span data-stu-id="c740c-117">Delegates roughly equate to function pointers, commonly used in Visual C++ and other object-oriented languages.</span></span> <span data-ttu-id="c740c-118">但与函数指针不同的是，委托是面向对象的、类型安全的和保险的。</span><span class="sxs-lookup"><span data-stu-id="c740c-118">Unlike function pointers however, delegates are object-oriented, type-safe, and secure.</span></span> <span data-ttu-id="c740c-119">另外，函数指针只包含对特定函数的引用，而委托由对对象的引用以及对该对象内一个或多个方法的引用组成。</span><span class="sxs-lookup"><span data-stu-id="c740c-119">Also, where a function pointer contains only a reference to a particular function, a delegate consists of a reference to an object, and references to one or more methods within the object.</span></span>

<span data-ttu-id="c740c-120">此事件模型使用“委托”将事件绑定到用来处理它们的方法。</span><span class="sxs-lookup"><span data-stu-id="c740c-120">This event model uses *delegates* to bind events to the methods that are used to handle them.</span></span> <span data-ttu-id="c740c-121">委托允许其他类通过指定处理程序方法来注册事件通知。</span><span class="sxs-lookup"><span data-stu-id="c740c-121">The delegate enables other classes to register for event notification by specifying a handler method.</span></span> <span data-ttu-id="c740c-122">当发生事件时，委托会调用绑定的方法。</span><span class="sxs-lookup"><span data-stu-id="c740c-122">When the event occurs, the delegate calls the bound method.</span></span> <span data-ttu-id="c740c-123">有关如何定义委托的详细信息，请参阅[处理和引发事件](/dotnet/standard/events/index)。</span><span class="sxs-lookup"><span data-stu-id="c740c-123">For more information about how to define delegates, see [Handling and raising events](/dotnet/standard/events/index).</span></span>

<span data-ttu-id="c740c-124">委托可绑定到单个方法或多个方法，后者又称为多路广播。</span><span class="sxs-lookup"><span data-stu-id="c740c-124">Delegates can be bound to a single method or to multiple methods, referred to as multicasting.</span></span> <span data-ttu-id="c740c-125">创建事件的委托时，通常会创建多播事件。</span><span class="sxs-lookup"><span data-stu-id="c740c-125">When creating a delegate for an event, you typically create a multicast event.</span></span> <span data-ttu-id="c740c-126">极少的例外情况是，事件可能会生成一个特定过程（例如显示对话框），而该过程在逻辑上不在每个事件中重复多次。</span><span class="sxs-lookup"><span data-stu-id="c740c-126">A rare exception might be an event that results in a specific procedure (such as displaying a dialog box) that wouldn't logically repeat multiple times per event.</span></span> <span data-ttu-id="c740c-127">有关如何创建多播委托的信息，请参阅[如何合并委托（多播委托）](/dotnet/csharp/programming-guide/delegates/how-to-combine-delegates-multicast-delegates)。</span><span class="sxs-lookup"><span data-stu-id="c740c-127">For information about how to create a multicast delegate, see [How to combine delegates (Multicast Delegates)](/dotnet/csharp/programming-guide/delegates/how-to-combine-delegates-multicast-delegates).</span></span>

<span data-ttu-id="c740c-128">多播委托维护它所绑定到的方法的调用列表。</span><span class="sxs-lookup"><span data-stu-id="c740c-128">A multicast delegate maintains an invocation list of the methods it's bound to.</span></span> <span data-ttu-id="c740c-129">多路广播委托支持将方法添加到调用列表的 <xref:System.Delegate.Combine%2A> 方法以及将其移除的 <xref:System.Delegate.Remove%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="c740c-129">The multicast delegate supports a <xref:System.Delegate.Combine%2A> method to add a method to the invocation list and a <xref:System.Delegate.Remove%2A> method to remove it.</span></span>

<span data-ttu-id="c740c-130">当应用程序记录某个事件时，该控件将通过调用该事件的委托引发事件。</span><span class="sxs-lookup"><span data-stu-id="c740c-130">When an event is recorded by the application, the control raises the event by invoking the delegate for that event.</span></span> <span data-ttu-id="c740c-131">委托依次调用绑定的方法。</span><span class="sxs-lookup"><span data-stu-id="c740c-131">The delegate in turn calls the bound method.</span></span> <span data-ttu-id="c740c-132">最常见的情况（多播委托）是，委托依次调用调用列表中的每个绑定方法，这样可提供一对多通知。</span><span class="sxs-lookup"><span data-stu-id="c740c-132">In the most common case (a multicast delegate), the delegate calls each bound method in the invocation list in turn, which provides a one-to-many notification.</span></span> <span data-ttu-id="c740c-133">此策略意味着控件不需要维护事件通知的目标对象列表 - 委托可处理所有的注册和通知。</span><span class="sxs-lookup"><span data-stu-id="c740c-133">This strategy means that the control doesn't need to maintain a list of target objects for event notification—the delegate handles all registration and notification.</span></span>

<span data-ttu-id="c740c-134">委托还允许将多个事件绑定到同一个方法上，从而允许多对一通知。</span><span class="sxs-lookup"><span data-stu-id="c740c-134">Delegates also enable multiple events to be bound to the same method, allowing a many-to-one notification.</span></span> <span data-ttu-id="c740c-135">例如，单击按钮事件和单击菜单命令事件都能调用同一委托，然后该委托调用单个方法以相同方式处理各个事件。</span><span class="sxs-lookup"><span data-stu-id="c740c-135">For example, a button-click event and a menu-command–click event can both invoke the same delegate, which then calls a single method to handle these separate events the same way.</span></span>

<span data-ttu-id="c740c-136">与委托一起使用的绑定机制是动态的：委托可在运行时绑定到其签名与事件处理程序的签名相匹配的任何方法上。</span><span class="sxs-lookup"><span data-stu-id="c740c-136">The binding mechanism used with delegates is dynamic: a delegate can be bound at run-time to any method whose signature matches that of the event handler.</span></span> <span data-ttu-id="c740c-137">借助此功能，你可以根据条件设置或更改绑定方法，并动态地将事件处理程序附加到控件上。</span><span class="sxs-lookup"><span data-stu-id="c740c-137">With this feature, you can set up or change the bound method depending on a condition and to dynamically attach an event handler to a control.</span></span>

## <a name="see-also"></a><span data-ttu-id="c740c-138">另请参阅</span><span class="sxs-lookup"><span data-stu-id="c740c-138">See also</span></span>

- [<span data-ttu-id="c740c-139">处理和引发事件</span><span class="sxs-lookup"><span data-stu-id="c740c-139">Handling and raising events</span></span>](/dotnet/standard/events/index)

<!-- TODO
- [Creating Event Handlers in Windows Forms](creating-event-handlers-in-windows-forms.md)
- [Event Handlers Overview](event-handlers-overview-windows-forms.md)-->
